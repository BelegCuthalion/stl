\documentclass[a4paper, 12pt]{paper}
\input{../preamble.tex}
\begin{document}

\subsection*{Cut Reduction}
  Let \textbf{S} be the system $\mathbf{LDL}^{*}$ ($\mathbf{LDL}^{*}_{\rightsquigarrow}$) with any one of the rules $L$, $R'$, $F$($F_\rightsquigarrow$) or $Fu'$. If $\mathbf{S} + \nabla Cut$ proves $\Gamma \Rightarrow \nabla^m A$ and $\Sigma , \{\nabla^{n_i} A\} \Rightarrow \Delta$ with proof trees of ranks less than $\rho(A)$, then it also proves $\{\nabla^{n_i} \Gamma\} , \nabla^m\Sigma \Rightarrow \nabla^m\Delta$ also with a proof tree of a rank less than $\rho(A)$.

  \emph{Proof:} We have the following proof-trees
  \[
    {\mathcal{D}_0
    \atop
    \Gamma \Rightarrow \nabla^m A}
    \hspace{3em}
    {\mathcal{D}_1
    \atop
    \Sigma , \{\nabla^{n_i} A\} \Rightarrow \Delta}
  \]
  both of a lower rank than that of $A$, and we want to construct a proof-tree
  \[\mathcal{D} \atop \{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma \Rightarrow \nabla^m \Delta \]
  without increasing the cut rank.

  The construction takes place in different cases for the last rule that occurs in $\mathcal{D}_0$ and $\mathcal{D}_1$. 
  We will use induction on the length of both $\mathcal{D}_0$ and $\mathcal{D}_1$ as follows; For any two proof-trees $\mathcal{D}_0'$ and $\mathcal{D}_1'$ such that $h(\mathcal{D}_0') + h(\mathcal{D}_1') < h(\mathcal{D}_0) + h(\mathcal{D}_1)$, where $\mathcal{D}_0'$ proves $\Gamma' \Rightarrow \nabla^{m'} A'$ and $\mathcal{D}_1'$ proves $\Sigma', \{\nabla^{n'_i} A'\} \Rightarrow \Delta'$ for arbitrary $\Gamma'$, $\Sigma'$, $\Delta'$, $A'$, $m'$ and $n_i'$, for which we have $\rho(\mathcal{D}_0'),\mathcal{D}_1' < \rho(A')$, the induction hypothesis give us a proof-tree $\text{IH}(\mathcal{D}_0', \mathcal{D}_1')$ that proves $\{\nabla^{n_i'}\Gamma'\}, \nabla^{m'} \Sigma' \Rightarrow \nabla^{m'} \Delta'$, and we also have $\rho(\text{IH}(\mathcal{D}_0', \mathcal{D}_1')) < \rho(A')$.

  In the cases where it is possible, we will also consider whether the cut-formula is altered in the last rule or not and use a different strategy to construct the desired proof: In the cases where there is a principal formula other than $A$ in one of the sub-trees, the construction is independent of the other sub-tree. While for the cases that $A$ is altered (modulo $\nabla$) on both sides, the last rule in one sub-tree determines a specific form for $A$, which in turn determines the last rule of the other sub-tree.
  
  For many cases where $A$ is not principal, we can devise a construction independent of the last rule, if the rule is $\nabla$-invariant. To this end, we will solve the cases for two rule schemes introduced below.

  \textbf{Rule Scheme 1:} Suppose $\tau$ is the last rule in $\mathcal{D}_0$ and has a principal formula other that $A$ and has assumption(s) $\mathcal{D}_0'$ (and $\mathcal{D}_0''$).
  Also assume that $\tau$ commutes with $\nabla$, i.e. $\tau(\nabla \Pi', \nabla \Pi'') = \nabla \tau(\Pi', \Pi'')$.
  
    \begin{prooftree}
      \noLine
      \AXC{$\mathcal{D}_0'$}
      \UIC{$\Gamma, \Pi' \Rightarrow \nabla^m A$}
      
      \noLine
      \AXC{$\mathcal{D}_0''$}
      \UIC{$\Gamma, \Pi'' \Rightarrow \nabla^m A$}
      
      \RightLabel{$\tau$}
      \BIC{$\Gamma, \tau(\Pi', \Pi'') \Rightarrow \nabla^m A$}
   \end{prooftree}
  
   To construct the desired proof-tree, it suffices to apply $\tau$ on $IH(\mathcal{D}_0', \mathcal{D}_1)$ (and possibly $IH(\mathcal{D}_0'', \mathcal{D}_1)$). So we would have

   \begin{prooftree}
    \noLine
		\AXC{$\mathcal{D}_0'$}
		\UIC{$\Gamma, \Pi' \Rightarrow \nabla^m A$}
		
		\noLine
		\AXC{$\mathcal{D}_1$}
		\UIC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow \Delta$}
		
		\RightLabel{IH}
		\BIC{$\{\nabla^{n_i} \Gamma, \nabla^{n_i} \Pi'\}, \nabla^m \Sigma \Rightarrow \nabla^m \Delta$}
		

    \noLine
		\AXC{$\mathcal{D}_0''$}
		\UIC{$\Gamma, \Pi'' \Rightarrow \nabla^m A$}
		
		\noLine
		\AXC{$\mathcal{D}_1$}
		\UIC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow \Delta$}
		
		\RightLabel{IH}
    \BIC{$\{\nabla^{n_i} \Gamma, \nabla^{n_i} \Pi''\}, \nabla^m \Sigma \Rightarrow \nabla^m \Delta$}

		\RightLabel{$\tau$}
		\BIC{$\{\nabla^{n_i} \Gamma, \nabla^{n_i} \tau(\Pi', \Pi'')\}, \nabla^m \Sigma \Rightarrow \nabla^m \Delta$}
   \end{prooftree}
   
   \textbf{Rule Scheme 2:} Now for the other rule scheme, suppose $\tau$ is the last rule in $\mathcal{D}_1$ which is $\nabla$-invariant and has a principal formula other that $A$ and has assumption(s) $\mathcal{D}_1'$ (and $\mathcal{D}_1''$).
     
   \begin{prooftree}
    \noLine
    \AXC{$\mathcal{D}_1'$}
    \UIC{$\Sigma, \{\nabla^{n_i} A\}, \Pi' \Rightarrow \Delta'$}
    
    \noLine
    \AXC{$\mathcal{D}_1''$}
    \UIC{$\Sigma, \{\nabla^{n_i} A\}, \Pi'' \Rightarrow \Delta''$}
    
    \RightLabel{$\tau$}
    \BIC{$\Sigma, \{\nabla^{n_i} A\}, \tau(\Pi', \Pi'') \Rightarrow \tau(\Delta', \Delta'')$}
 \end{prooftree}
 
 Again, we just need to apply $\tau$ on $IH(\mathcal{D}_0, \mathcal{D}_1')$ (and possibly $IH(\mathcal{D}_0, \mathcal{D}_1'')$) to get

 \begin{prooftree}
  \noLine
  \AXC{$\mathcal{D}_0$}
  \UIC{$\Gamma \Rightarrow \nabla^m A$}
  
  \noLine
  \AXC{$\mathcal{D}_1'$}
  \UIC{$\Sigma, \{\nabla^{n_i} A\}, \Pi' \Rightarrow \Delta'$}
  
  \RightLabel{IH}
  \BIC{$\{\nabla^{n_i} \Gamma\}, \nabla^m \Sigma, \nabla^m \Pi' \Rightarrow \nabla^m \Delta'$}

  \noLine
  \AXC{$\mathcal{D}_0$}
  \UIC{$\Gamma \Rightarrow \nabla^m A$}
  
  \noLine
  \AXC{$\mathcal{D}_1''$}
  \UIC{$\Sigma, \{\nabla^{n_i} A\}, \Pi'' \Rightarrow \Delta''$}
  
  \RightLabel{IH}
  \BIC{$\{\nabla^{n_i} \Gamma\}, \nabla^m \Sigma, \nabla^m \Pi'' \Rightarrow \nabla^m \Delta''$}
  
  \RightLabel{$\tau$}
  \BIC{$\{\nabla^{n_i} \Gamma\}, \nabla^m \Sigma, \nabla^m \tau(\Pi', \Pi''), \Rightarrow \nabla^m \tau(\Delta', \Delta'')$}
 \end{prooftree}

 Back to the main proof scheme, the order in which the cases are handled is as follows: First, construct the desired proof-tree in the cases that $\mathcal{D}_0$ is an axiom, independent of $\mathcal{D}_1$. The case for $Id$ is trivial, $Ex$ won't happen and $Ta$ is handled by lemma \ref{lem:ldls-top-redundant}. Then take any of the rules $Lw$, $Lc$, $L\land_1$, $L\land_2$, $L\lor$, $L\Box$, $L$ or $R'$ to be the last rule in $\mathcal{D}_0$. All these cases are instances of the first rule scheme and are handled as shown above.
 
 There are other cases for the last rule in $\mathcal{D}_0$ that are handled independent of $\mathcal{D}_1$: $L\rightarrow$, $L\rightsquigarrow$, $\nabla Cut$, $Rw$, $N$ and $Fu'$. The desired proof-tree is constructed for these cases as follows.\\

 $L\rightarrow$: Suppose $\mathcal{D}_0$ ends with a $L\rightarrow$ as shown below.
 \begin{prooftree}
  \noLine
  \AXC{$\mathcal{D}_0'$}
  \UIC{$\Gamma \Rightarrow \nabla^r B$}
  \noLine
  \AXC{$\mathcal{D}_0''$}
  \UIC{$\Gamma , \nabla^r C \Rightarrow \nabla^m A$}
  \RightLabel{$L\rightarrow$}
  \BIC{$\Gamma , \nabla^{r} (B \rightarrow C) \Rightarrow \nabla^m A$}
 \end{prooftree}
 From induction hypothesis for $\mathcal{D}_0''$ and $\mathcal{D}_1$, we have
 \begin{prooftree}
  \noLine
  \AXC{$\mathcal{D}_0''$}
  \UIC{$\Gamma , \nabla^r C \Rightarrow \nabla^m A$}
  \noLine
  \AXC{$\mathcal{D}_1$}
  \UIC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow \Delta$}
  \RightLabel{IH} \LeftLabel{$IH(\mathcal{D}_0'', \mathcal{D}_1):~~~~$}
  \BIC{$\{\nabla^{n_i} \Gamma , \nabla^{n_i+r} C\} , \nabla^m \Sigma \Rightarrow \nabla^m \Delta$}
 \end{prooftree}
 In order to apply $L\rightarrow$, we must prepare the context in $\mathcal{D}_0'$ for each of $\nabla^{n_i+r}C$'s. Beginning with $n_0$, first we need to apply $N$ on $\mathcal{D}_0'$ $n_0$ times to get $\nabla^{n_0}\Gamma$ on the left and $\nabla^{n_0+r} B$ on the right side. Then we can just add the rest of the context by $Lw$.
 \begin{prooftree}
  \noLine
  \AXC{$\mathcal{D}_0'$}
  \UIC{$\Gamma \Rightarrow \nabla^r B$}
  \doubleLine \RightLabel{$N'$}
  \UIC{$\nabla^{n_0} \Gamma \Rightarrow \nabla^{n_0+r} B$}
  \doubleLine \RightLabel{$Lw$}
  \UIC{$\nabla^{n_0}\Gamma, \{\nabla^{n_i} \Gamma, \nabla^{n_i+r}C\}_{i>0} , \nabla^m \Sigma \Rightarrow \nabla^{n_0+r} B$}
 \end{prooftree}
 By $L\rightarrow$ we will have $\nabla^{n_0}\Gamma, \{\nabla^{n_i} \Gamma, \nabla^{n_i+r}C\}_{i>0}, \nabla^{n_0+r} (B \rightarrow C) , \nabla^m \Sigma \Rightarrow \nabla^m \Delta$. We can repeat this for all $n_i$'s to get $\{\nabla^{n_i} \Gamma, \nabla^{n_i+r}(B \rightarrow C)\}, \nabla^m \Sigma \Rightarrow \nabla^m \Delta$, which is the desired sequent.\\

 $L\rightsquigarrow$: Is just same as the last case, except that the rule $L\rightsquigarrow$ adds an additional $\nabla$ to the resulting implication on the left of the sequent, which won't effect our proof.\\

 $\nabla Cut$: Assume $\mathcal{D}_0$ ends with a $\nabla Cut$ on $A'$, which by assumption must be of a lower rank than $A$.
 \begin{prooftree}
   \noLine
   \AXC{$\mathcal{D}_0'$}
   \UIC{$\Gamma \Rightarrow \nabla^{m'} A'$}
   
   \noLine
   \AXC{$\mathcal{D}_0''$}
   \UIC{$\Pi , \{\nabla^{n_i'} A'\} \Rightarrow \nabla^m A$}
   
   \RightLabel{$\nabla Cut$}
   \BIC{$\{\nabla^{n_i'} \Gamma\} , \nabla^{m'} \Pi \Rightarrow \nabla^{m+m'} A$}
 \end{prooftree}
 We must construct a proof-tree for $\{\nabla^{n_i}\{\nabla^{n_i'} \Gamma\}, \nabla^{n_i+m'} \Pi\} , \nabla^{m+m'}\Sigma \Rightarrow \nabla^{m+m'}\Delta$. We can use the induction hypothesis to remove $A$ first, then cut $A'$.
 \begin{prooftree}
   \noLine
   \AXC{$\mathcal{D}_0'$}
   \UIC{$\Gamma \Rightarrow \nabla^{m'} A'$}
   
   \noLine
   \AXC{$\mathcal{D}_0''$}
   \UIC{$\Pi , \{\nabla^{n_i'} A'\} \Rightarrow \nabla^m A$}

   \noLine
   \AXC{$\mathcal{D}_1$}
   \UIC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow \Delta$}

   \RightLabel{IH}
   \BIC{$\{\nabla^{n_i} \Pi , \nabla^{n_i}\{\nabla^{n_i'} A'\}\} , \nabla^m \Sigma \Rightarrow \nabla^m \Delta$}
   

   \RightLabel{$MC$}
   \BIC{$\{\nabla^{n_i}\{\nabla^{n_i'} \Gamma\}, \nabla^{n_i+m'} \Pi\} , \nabla^{m+m'}\Sigma \Rightarrow \nabla^{m+m'}\Delta$}
 \end{prooftree}\emph{}\\

 $Rw$: In this case, $\mathcal{D}_0'$ proves $\Gamma \Rightarrow$, so we can simply construct the desired proof-tree using $N$, $Lw$ and $Rw$.
 \begin{prooftree}
   \noLine
   \AXC{$\mathcal{D}_0'$}
   \UIC{$\Gamma \Rightarrow$}
   \doubleLine \RightLabel{$N$}
   \UIC{$\nabla^{n_0} \Gamma \Rightarrow$}
   \doubleLine \RightLabel{$Lw$}
   \UIC{$\{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma \Rightarrow$}
   \RightLabel{$Rw$}
   \UIC{$\{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma \Rightarrow \nabla^m \Delta$}
 \end{prooftree}\emph{}\\

 $N$: $\mathcal{D}_0$ proves $\nabla \Gamma \Rightarrow \nabla^{m+1} A$ and the cut-formula is in the form $\nabla A$. So we want to construct $\{\nabla^{n_i+1}\Gamma\}, \nabla^m \Sigma \Rightarrow \nabla^m \Delta$. Induction hypothesis for $\mathcal{D}_0'$ and $\mathcal{D}_1$ gives exactly what we want.\\

 $Fu'$: This case is also handled similar to how we did the rule scheme 1.
 It suffices to apply $Fu'$ on $IH(\mathcal{D}_0', \mathcal{D}_1)$.\\

 The rest of the cases for $\mathcal{D}_0$ can't be solve independent of $\mathcal{D}_1$, so we will consider cases for the last rule of $\mathcal{D}_1$, again, where they're handled independent of $\mathcal{D}_0$.
 But this time we have much less possibilities for the opposite sub-tree, since we've already solved many of them. In fact the only possible rules for the last rule of $\mathcal{D}_0$ are now $R\star (\star \in \{\land, \lor_{1/2}, \rightarrow, \Box, \rightsquigarrow\})$, $F$ and $F_\rightsquigarrow$.

 This time, suppose $\mathcal{D}_1$ is and axiom. Again, the $Id$ case is trivial, $Ta$ won't happen, and $Ex$ is also infeasible, since all possible rules for $\mathcal{D}_0$ alter the right side of the sequent, but none of them is able to introduce $\bot$ there.

 For cases where there is a principal formula other than any instance of the cut-formula at the end of $\mathcal{D}_1$, we use the construction introduced for rule scheme 2. Rules $Lw$, $Rw$, $Lc$, $L\land_1$, $L\land_2$, $R\land$, $L\lor$, $R\lor_1$, $R\lor_2$, $L\Box$, $R\Box$, $L$, $R'$, $F$ and $F_\rightsquigarrow$ are all instances of this scheme. Cases that do not follow this scheme, i.e. $L\rightarrow$, $R\rightarrow$, $L\rightsquigarrow$, $R\rightsquigarrow$, $N$, $Fu'$ and $\nabla Cut$, are handled below.\\

 $L\rightarrow$: Suppose $\mathcal{D}_1$ ends with $L\rightarrow$, but no instance of the cut-formula is principal.
		\begin{prooftree}
			\noLine
			\AXC{$\mathcal{D}_1'$}
			\UIC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow \nabla^r B$}

			\noLine
			\AXC{$\mathcal{D}_1''$}
			\UIC{$\Sigma , \{\nabla^{n_i} A\} , \nabla^r C \Rightarrow \Delta$}

			\RightLabel{$L\rightarrow$}
			\BIC{$\Sigma , \{\nabla^{n_i} A\} , \nabla^r (B \rightarrow C) \Rightarrow \Delta$}
		\end{prooftree}
    To construct a proof-tree for $\{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma , \nabla^{m+r} (B \rightarrow C) \Rightarrow \nabla^m \Delta$, just apply $L\rightarrow$ on $IH(\mathcal{D}_0, \mathcal{D}_1')$ and $IH(\mathcal{D}_0, \mathcal{D}_1'')$.
		\begin{prooftree}
			\noLine
			\AXC{$\mathcal{D}_0$}
			\UIC{$\Gamma \Rightarrow \nabla^m A$}

			\noLine
			\AXC{$\mathcal{D}_1'$}
			\UIC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow \nabla^r B$}

			\RightLabel{IH}
			\BIC{$\{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma \Rightarrow \nabla^{m+r} B$}

			\noLine
			\AXC{$\mathcal{D}_0$}
			\UIC{$\Gamma \Rightarrow \nabla^m A$}

			\noLine
			\AXC{$\mathcal{D}_1''$}
			\UIC{$\Sigma , \{\nabla^{n_i} A\} , \nabla^r C \Rightarrow \nabla^m \Delta$}

			\RightLabel{IH}
			\BIC{$\{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma , \nabla^{m+r} C \Rightarrow \nabla^m \Delta$}

			\RightLabel{$L\rightarrow$}
			\BIC{$\{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma , \nabla^{m+r} (B \rightarrow C) \Rightarrow \nabla^m \Delta$}
    \end{prooftree} \emph{}\\

    $R\rightarrow$: Suppose $\mathcal{D}_1$ ends with $R\rightarrow$.
    \begin{prooftree}
			\noLine
			\AXC{$\mathcal{D}_1'$}
			\UIC{$\Sigma, \{\nabla^{n_i} A\}, B \Rightarrow C$}
			\RightLabel{$R\rightarrow$}
			\UIC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow B \rightarrow C$}
		\end{prooftree}
		Applying $R\rightarrow$ on $IH(\mathcal{D}_0, \mathcal{D}_1')$, we can construct a proof-tree for $\{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma \Rightarrow \nabla^m (B \rightarrow C)$.
		\begin{prooftree}
			\noLine
			\AXC{$\mathcal{D}_0$}
			\UIC{$\Gamma \Rightarrow \nabla^m A$}
			
			\noLine
			\AXC{$\mathcal{D}_1'$}
			\UIC{$\Sigma, \{\nabla^{n_i} A\}, B \Rightarrow C$}
			\RightLabel{IH}
			\BIC{$\{\nabla^{n_i} \Gamma\}, \nabla^m \Sigma, \nabla^m B \Rightarrow \nabla^m C$}
			
			\RightLabel{$R\rightarrow$}
			\UIC{$\{\nabla^{n_i} \Gamma\}, \nabla^m \Sigma \Rightarrow \nabla^m (B \rightarrow C)$}
    \end{prooftree} \emph{}\\

    $L\rightsquigarrow$: Similar to the $L\rightarrow$ case, with an additional $\nabla$ on the implication introduced to the left of the sequent.\\

    $R\rightsquigarrow$: Suppose $\mathcal{D}_1$ ends with $R\rightsquigarrow$.
    \begin{prooftree}
			\noLine
			\AXC{$\mathcal{D}_1'$}
			\UIC{$\nabla \Sigma , \{\nabla^{n_i+1} A\} , B \Rightarrow C$}
			\RightLabel{$R\rightsquigarrow$}
			\UIC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow B \rightsquigarrow C$}
		\end{prooftree}
		We will get $\{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma \Rightarrow \nabla^m (B \rightarrow C)$ using $R\rightsquigarrow$ on $\mathcal{D}_0$ and $\mathcal{D}_1'$
		\begin{prooftree}
			\noLine
			\AXC{$\mathcal{D}_0$}
			\UIC{$\Gamma \Rightarrow \nabla^m A$}
			
			\noLine
			\AXC{$\mathcal{D}_1'$}
			\UIC{$\nabla \Sigma , \{\nabla^{n_i+1} A\} , B \Rightarrow C$}
			\RightLabel{IH}
			\BIC{$\{\nabla^{n_i+1} \Gamma\} , \nabla^{m+1} \Sigma , \nabla^m B \Rightarrow \nabla^m C$}
			
			\RightLabel{$R\rightsquigarrow$}
			\UIC{$\{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma \Rightarrow \nabla^m (B \rightarrow C)$}
    \end{prooftree} \emph{} \\
    
    $N$: Suppose $\mathcal{D}_1$ ends with $N$.
    \begin{prooftree}
      \noLine
      \AXC{$\mathcal{D}_1'$}
      \UIC{$\Sigma , \{\nabla^{n+i} A\} \Rightarrow \Delta$}
      \RightLabel{$N$}
      \UIC{$\nabla \Sigma , \{\nabla^{n_i+1} A\} \Rightarrow \nabla \Delta$}
    \end{prooftree}
    Prove $\{\nabla^{n_i+1} \Gamma\} , \nabla^{m+1} \Sigma \Rightarrow \nabla^{m+1} \Delta$ by applying $N$ on $\mathcal{D}_0$ and $\mathcal{D}_1'$
    \begin{prooftree}
      \noLine
      \AXC{$\mathcal{D}_0$}
      \UIC{$\Gamma \Rightarrow \nabla^m A$}
      
      \noLine
      \AXC{$\mathcal{D}_1'$}
      \UIC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow \Delta$}
      \RightLabel{IH}
      \BIC{$\{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma \Rightarrow \nabla^m \Delta$}
      
      \RightLabel{$N$}
      \UIC{$\{\nabla^{n_i+1} \Gamma\} , \nabla^{m+1} \Sigma \Rightarrow \nabla^{m+1} \Delta$}
    \end{prooftree} \emph{}\\

    $N$: This case is similar to $N$. Suppose $\mathcal{D}_1$ ends with $Fu'$.
    \begin{prooftree}
      \noLine
      \AXC{$\mathcal{D}_1'$}
      \UIC{$\nabla \Sigma , \{\nabla^{n_i+1} A\} \Rightarrow \nabla \Delta$}
      \RightLabel{$Fu'$}
      \UIC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow \Delta$}
    \end{prooftree}
    We have $\{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma \Rightarrow \nabla^m \Delta$ from applying $Fu'$ on $\mathcal{D}_0$ and $\mathcal{D}_1'$
    \begin{prooftree}
      \noLine
      \AXC{$\mathcal{D}_0$}
      \UIC{$\Gamma \Rightarrow \nabla^m A$}
      
      \noLine
      \AXC{$\mathcal{D}_1'$}
      \UIC{$\nabla \Sigma , \{\nabla^{n_i+1} A\} \Rightarrow \nabla \Delta$}
      \RightLabel{IH}
      \BIC{$\{\nabla^{n_i+1} \Gamma\} , \nabla^{m+1} \Sigma \Rightarrow \nabla^{m+1} \Delta$}
      
      \RightLabel{$Fu'$}
      \UIC{$\{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma \Rightarrow \nabla^m \Delta$}
    \end{prooftree} \emph{}\\

    $\nabla Cut$: Assume $\mathcal{D}_1$ ends with $\nabla Cut$ on a some formula $A'$, which by assumption must be of a lower rank than $A$.
    \begin{prooftree}
      \noLine
      \AXC{$\mathcal{D}_1'$}
      \UIC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow \nabla^{m'} A'$}
  
      \noLine
      \AXC{$\mathcal{D}_1''$}
      \UIC{$\Pi , \{\nabla^{n_i'} A'\} \Rightarrow \Delta$}
  
      \RightLabel{$\nabla Cut$}
      \BIC{$\{\nabla^{n_i'} \Sigma\} , \{\nabla^{n_i+n_i'} A\} , \nabla^{m'} \Pi \Rightarrow \nabla^{m'} \Delta$}
    \end{prooftree}
    So we want to prove $\{\nabla^{n_i+n_i'} \Gamma\} , \{\nabla^{n_i'+m} \Sigma\} , \nabla^{m+m'} \Pi \Rightarrow \nabla^{m+m'} \Delta$. We can use the induction to remove $A$ first, then cut $A'$.
    \begin{prooftree}
      \noLine
      \AXC{$\mathcal{D}_0$}
      \UIC{$\Gamma \Rightarrow \nabla^m A$}
  
      \noLine
      \AXC{$\mathcal{D}_1'$}
      \UIC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow \nabla^{m'} A'$}
  
      \RightLabel{IH}
      \BIC{$\{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma \Rightarrow \nabla^{m+m'} A'$}
  
      \noLine
      \AXC{$\mathcal{D}_1''$}
      \UIC{$\Pi , \{\nabla^{n_i'} A'\} \Rightarrow \Delta$}
  
      \RightLabel{$\nabla Cut$}
      \BIC{$\{\nabla^{n_i+n_i'} \Gamma\} , \{\nabla^{n_i'+m} \Sigma\} , \nabla^{m+m'} \Pi \Rightarrow \nabla^{m+m'} \Delta$}
    \end{prooftree}

    Now for the rest of the proof, we will show how the construction takes place in the cases where the cut-formula is principal in the last rule of $\mathcal{D}_1$, which can be either of $L\star (\star \in \{\land, \lor_{1/2}, \rightarrow, \Box, \rightsquigarrow\})$.
    Any of these rules imply a specific form for the cut-formula, which can also determine the rule at the end of the other proof-tree, because the cut-formula is also principal in the last rule of $\mathcal{D}_0$ (note that the only possible rules for the last rule of $\mathcal{D}_0$ are now $R\star (\star \in \{\land, \lor_{1/2}, \rightarrow, \Box, \rightsquigarrow\})$, $F$ and $F_\rightsquigarrow$).
    Now we further destruct the proof by cases for $m$.
    
    First, notice that $m > 1$ is impossible, since the only rules that introduce $\nabla$ to the right of the sequence are $F$ for $\mathbf{LDL}$ based systems and $F_\rightsquigarrow$ for $\mathbf{LDL}_\rightsquigarrow$ based ones. So suppose $m = 1$ and $\mathcal{D}_0$ end with $F$ (in $\mathbf{LDL}$).
    \begin{prooftree}
      \AXC{$\mathcal{D}_0'$}
      \noLine
      \UIC{$\Gamma \Rightarrow A$}
      \RightLabel{$F$}
      \UIC{$\Gamma \Rightarrow \nabla \Box A$}
    \end{prooftree}
    Now the cut-formula must be of the form $\Box A$, so the only option for $\mathcal{D}_1$ is $L\Box$.
    \begin{prooftree}
      \AXC{$\mathcal{D}_1'$}
      \noLine
      \UIC{$\Sigma, \{\nabla^{n_i} \Box A\}_{i>0}, \nabla^{n_0} A \Rightarrow \Delta$}
      \RightLabel{$L\Box$}
      \UIC{$\Sigma, \{\nabla^{n_i} \Box A\}_{i>0}, \nabla^{n_0+1} \Box A \Rightarrow \Delta$}
    \end{prooftree}
    The desired sequent is of the form $\{\nabla^{n_i} \Gamma\}_{i>0}, \nabla^{n_0+1} \Gamma, \nabla \Sigma \Rightarrow \nabla \Delta$, which can be proved by a low rank $\nabla Cut$ (with $A$ as the cut-formula) on $\mathcal{D}_0'$ and $IH(\mathcal{D}_0, \mathcal{D}_1')$.
    \begin{prooftree}
      \AXC{$\mathcal{D}_0'$}
      \noLine
      \UIC{$\Gamma \Rightarrow A$}
      \AXC{$\mathcal{D}_0$}
      \noLine
      \UIC{$\Gamma \Rightarrow \nabla \Box A$}
      \AXC{$\mathcal{D}_1'$}
      \noLine
      \UIC{$\Sigma, \{\nabla^{n_i} \Box A\}_{i>0}, \nabla^{n_0} A \Rightarrow \Delta$}
      \RightLabel{IH}
      \BIC{$\{\nabla^{n_i} \Gamma\}_{i>0}, \nabla \Sigma, \nabla^{n_0+1} A \Rightarrow \nabla \Delta$}
      \RightLabel{$\nabla Cut$}
      \BIC{$\{\nabla^{n_i} \Gamma\}_{i>0}, \nabla^{n_0+1} \Gamma, \nabla \Sigma \Rightarrow \nabla \Delta$}
    \end{prooftree}

    Now suppose $\mathcal{D}_0$ ends with $F_\rightsquigarrow$ (in $\mathbf{LDL}_\rightsquigarrow$).
    \begin{prooftree}
      \AXC{$\mathcal{D}_0'$}
      \noLine
      \UIC{$\Gamma, A \Rightarrow B$}
      \RightLabel{$F_\rightsquigarrow$}
      \UIC{$\Gamma \Rightarrow \nabla (A \rightsquigarrow B)$}
    \end{prooftree}
    Since the cut-formula is of the form $A \rightsquigarrow B$, $\mathcal{D}_1$ could only end with $L\rightsquigarrow$.
    \begin{prooftree}
      \AXC{$\mathcal{D}_1'$}
      \noLine
      \UIC{$\Sigma, \{\nabla^{n_i} (A \rightsquigarrow B) \}_{i>0}, \Rightarrow \nabla^{n_0} A$}
      \AXC{$\mathcal{D}_1''$}
      \noLine
      \UIC{$\Sigma, \{\nabla^{n_i} (A \rightsquigarrow B) \}_{i>0}, \nabla^{n_0} B \Rightarrow \Delta$}
      \RightLabel{$L\rightsquigarrow$}
      \BIC{$\Sigma, \{\nabla^{n_i} (A \rightsquigarrow B)\}_{i>0}, \nabla^{n_0+1} (A \rightsquigarrow B) \Rightarrow \Delta$}
    \end{prooftree}
    Again, we want to prove $\{\nabla^{n_i} \Gamma\}_{i>0}, \nabla^{n_0+1} \Gamma, \nabla \Sigma \Rightarrow \nabla \Delta$. To do so, we first apply a low rank $\nabla Cut$ (with $B$ as the cut-formula) on $\mathcal{D}_0'$ and $IH(\mathcal{D}_0, \mathcal{D}_1'')$.
    \begin{prooftree}
      \AXC{$\mathcal{D}_0'$}
      \noLine
      \UIC{$\Gamma, A \Rightarrow B$}
      \AXC{$\mathcal{D}_0$}
      \noLine
      \UIC{$\Gamma \Rightarrow \nabla (A \rightsquigarrow B)$}
      \AXC{$\mathcal{D}_1''$}
      \noLine
      \UIC{$\Sigma, \{\nabla^{n_i} (A \rightsquigarrow B) \}_{i>0}, \nabla^{n_0} B \Rightarrow \Delta$}
      \BIC{$\{\nabla^{n_i} \Gamma\}_{i>0}, \nabla \Sigma, \nabla^{n_0+1} B \Rightarrow \nabla \Delta$}
      \RightLabel{$\nabla Cut$} \LeftLabel{$\mathcal{D}':~~~~~$}
      \BIC{$\nabla^{n_0+1} \Gamma, \nabla^{n_0+1} A, \{\nabla^{n_i} \Gamma\}_{i>0}, \nabla \Sigma \Rightarrow \nabla \Delta$}
    \end{prooftree}
    Then cut $IH(\mathcal{D}_0, \mathcal{D}_1')$ (this time with $\nabla^{n_0+1} A$ as the cut-formula) into the resulting sequent.
    \begin{prooftree}
      \AXC{$\mathcal{D}_1'$}
      \noLine
      \UIC{$\Sigma, \{\nabla^{n_i} (A \rightsquigarrow B) \}_{i>0}, \Rightarrow \nabla^{n_0} A$}
      \AXC{$\mathcal{D}_0$}
      \noLine
      \UIC{$\Gamma \Rightarrow \nabla (A \rightsquigarrow B)$}
      \RightLabel{IH}
      \BIC{$\{\nabla^{n_i} \Gamma\}_{i>0}, \nabla \Sigma, \Rightarrow \nabla^{n_0 + 1} A$}

      \AXC{$\mathcal{D}'$}

      \RightLabel{$\nabla Cut$}
      \BIC{$(\{\nabla^{n_i} \Gamma\}_{i>0})^2, \nabla^{n_0+1} \Gamma, (\nabla \Sigma)^2 \Rightarrow \nabla \Delta$}
      \doubleLine \RightLabel{$Lc$}
      \UIC{$\{\nabla^{n_i} \Gamma\}_{i>0}, \nabla^{n_0+1} \Gamma, \nabla \Sigma \Rightarrow \nabla \Delta$}
    \end{prooftree}
    When $m = 0$, each right-rule for $\mathcal{D}_1$ determines its corresponding left-rule for $\mathcal{D}_0$.

    $R\land$ and $L\land$: Suppose $\mathcal{D}_0$ ends with $R\land$ and $\mathcal{D}_1$ with either of $L\land_c ~ (c \in \{1,2\})$.
		\begin{prooftree}
			\noLine
			\AXC{$\mathcal{D}_0'$}
      \UIC{$\Gamma \Rightarrow A_1$}
      \noLine
			\AXC{$\mathcal{D}_0''$}
			\UIC{$\Gamma \Rightarrow A_2$}
			\RightLabel{$R\land$}
			\BIC{$\Gamma \Rightarrow A_1 \land A_2$}
			
			\noLine
			\AXC{$\mathcal{D}_1'$}
			\UIC{$\Sigma , \{\nabla^{n_i} (A_1 \land A_2)\}_{i>0}, \nabla^{n_0} A_c \Rightarrow \Delta$}
			\RightLabel{$L\land_1$}
			\UIC{$\Sigma , \{\nabla^{n_i} (A_1 \land A_2)\} \Rightarrow \Delta$}
			
			\noLine
			\BIC{}
		\end{prooftree}
    $IH(\mathcal{D}_0, \mathcal{D}_1')$ proves $\{\nabla^{n_i} \Gamma\}_{i>0} , \Sigma , \nabla^{n_0} A_c \Rightarrow \Delta$. Remove $\nabla^{n_0} A_c$ with a low rank $\nabla Cut$ on this sequent and either of $\mathcal{D}_0'$ ($c = 1$) or $\mathcal{D}_0''$ ($c = 2$) to get $\{\nabla^{n_i} \Gamma\}, \Sigma \Rightarrow \Delta$.

    $R\lor$ and $L\lor$: Suppose $\mathcal{D}_0$ ends with either of $R\lor_c ~ (c \in \{1,2\})$ and $\mathcal{D}_1$ with $L\lor$.
		\begin{prooftree}
			\noLine
			\AXC{$\mathcal{D}_0'$}
			\UIC{$\Gamma \Rightarrow A_c$}
			\RightLabel{$R\lor_c$}
			\UIC{$\Gamma \Rightarrow A_1 \lor A_2$}

			\noLine
			\AXC{$\mathcal{D}_1'$}
      \UIC{$\Sigma , \{\nabla^{n_i} (A_1 \lor A_2)\}_{i>0} , \nabla^{n_0} A_1 \Rightarrow \Delta$}
      \noLine
      \AXC{$\mathcal{D}_1''$}
			\UIC{$\Sigma , \{\nabla^{n_i} (A_1 \lor A_2)\}_{i>0} , \nabla^{n_0} A_2 \Rightarrow \Delta$}
			\RightLabel{$L\lor$}
      \BIC{$\Sigma ,  \{\nabla^{n_i} (A_1 \lor A_2)\} \Rightarrow \Delta$}
      
      \noLine
      \BIC{}
		\end{prooftree}
    Using induction hypothesis, first remove $\{\nabla^{n_i} (A_1 \lor A_2)\}_{i>0}$ from the sub-tree of $\mathcal{D}_1$ that has $\nabla^{n_0} A_c$ ($IH(\mathcal{D}_0, \mathcal{D}_1')$ for $c = 1$, $IH(\mathcal{D}_0, \mathcal{D}_1'')$ for $c = 2$), to get $\{\nabla^{n_i} \Gamma\}_{i>0}, \Sigma , \nabla^{n_0} A_c \Rightarrow \Delta$. Then remove $\nabla^{n_0} A_c$ by a low rank $\nabla Cut$ on this sequent and $\mathbf{D_0}'$ to get $\{\nabla^{n_i} \Gamma\}, \Sigma \Rightarrow \Delta$.

    $R\rightarrow$ and $L\rightarrow$: Suppose $\mathcal{D}_0$ and $\mathcal{D}_1$ end with $R\rightarrow$ and $L\rightarrow$ respectively.
    \begin{prooftree}
			\noLine
			\AXC{$\mathcal{ D}_0'$}
			\UIC{$\Gamma, A_1 \Rightarrow A_2$}
			\RightLabel{$R\rightarrow$}
      \UIC{$\Gamma \Rightarrow A_1 \rightarrow A_2$}        
      \end{prooftree}
      \begin{prooftree}
			\noLine
			\AXC{$\mathcal{D}_1'$}
			\UIC{$\Sigma, \{\nabla^{n_i} (A_1 \rightarrow A_2)\}_{i>0} \Rightarrow \nabla^{n_0} A_1$}
			\noLine
			\AXC{$\mathcal{D}_1''$}
			\UIC{$\Sigma, \{\nabla^{n_i} (A_1 \rightarrow A_2)\}_{i>0}, \nabla^{n_0} A_2 \Rightarrow \Delta$}
			\RightLabel{$L\rightarrow$}
			\BIC{$\Sigma,  \{\nabla^{n_i} (A_1 \rightarrow A_2)\} \Rightarrow \Delta$}
    \end{prooftree}
    
    $IH(\mathcal{D}_0, \mathcal{D}_1'')$ proves $\{\nabla^{n_i} \Gamma\}_{i>0}, \Sigma, \nabla^{n_0} A_2 \Rightarrow \Delta$. Applying a low rank $\nabla Cut$ on $\mathcal{D}_0'$ and this sequent removes $\nabla^{n_0} A_2$ and introduces $\nabla^{n_0} \Gamma$ and $\nabla^{n_0} A_1$ to the left. On the other hand $IH(\mathcal{D}_0, \mathcal{D}_1')$ proves $\{\nabla^{n_i} \Gamma\}_{i>0}, \Sigma, \Rightarrow \nabla^{n_0} A_1$, which we can use to also remove $\nabla^{n_0} A_1$ with another low rank cut, and then remove the extra $\nabla^{n_0} \Gamma$ and $\Sigma$ with $Lc$.

    $R\rightsquigarrow$ and $L\rightsquigarrow$: Is just like the $\rightarrow$ case. Notice that the extra $\nabla$ on the left side of the subtree of $\mathcal{D}_0$ will provide the extra $\nabla$ on the principal formula in $\mathcal{D}_1$.

    There are also two cases where the sub-trees end with $F$ and $L\Box$, or with $F_\rightsquigarrow$ and $L\rightsquigarrow$ for $\mathbf{LDL}_\rightsquigarrow$, with $m = 0$. These cases are also similar to the $m = 1$ case, except that here the cut-formula is $\nabla\Box A$.
    \vspace{5mm}

    This concludes the proof the theorem in all cases. Notice that we have a construction for any two possible pair of rules, in both systems and all their variations.

  \end{document}