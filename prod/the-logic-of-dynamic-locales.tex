\documentclass[12pt,a4paper]{article}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
%\usepackage{fdsymbol}

\usepackage{authblk}

\usepackage[mathscr]{eucal}

\usepackage{bussproofs}
\EnableBpAbbreviations

\usepackage{amssymb}
\usepackage{tikz}
\usepackage{enumitem}
\tikzset{node distance=2cm, auto}

\theoremstyle{plain}
\newtheorem{thm}{Theorem}[section]

\renewcommand{\thethm}{\arabic{section}.\arabic{thm}}
\newtheorem{lem}[thm]{Lemma}

\newtheorem{cor}[thm]{Corollary}
\theoremstyle{definition}
\newtheorem{dfn}[thm]{Definition}
\newtheorem{exam}[thm]{Example}
\newtheorem{rem}[thm]{Remark}
\newtheorem{nota}[thm]{Notation}
\newtheorem{exer}[thm]{Exercise}

\def\d{\displaystyle}
\def\PA{\mathrm{PA}}
\def\Pr{\mathrm{Pr}}
\def\Prf{\mathrm{Prf}}
\def\PR{\mathrm{PR}}
\def\IPC{\mathrm{IPC}}
\def\Proofs{\mathrm{Proofs}}
\def\int{\mathrm{int}}
\def\WT{\mathrm{WT}}
\def\exp{\mathrm{exp}}
\def\CHaus{\mathrm{CHaus}}
\def\Fin{\mathrm{Fin}}
\def\E{\mathrm{E}}
\def\PR{\mathrm{PR}}
\def\Top{\mathrm{Top}}
\def\S4{\mathrm{S4}}
\def\Hom{\mathrm{Hom}}
\def\Set{\mathrm{Set}}

\begin{document}

\title{The Logic of Dynamic Locales}


\author[]{Amirhossein Akbar Tabatabai, Alireza Mahmoudian}

\affil[]{ }


\date{ }

\maketitle


\begin{abstract}
In this paper we will first introduce dynamic locales as the point-free intuitionistic version of the dynamic topological systems. Then we will introduce the logic of the dynamic locales, $\mathbf{LDL}$, as a base for the intuitionistic version for classical dynamic topological logic, introduced in \cite{Artemov}. We will then present cut-free sequent-style proof systems for the logic $\mathbf{LDL}$ and one of its important fragments. Using the systems, we will finally provide a syntactical proof for the admissibly of a natural extension of Visser rules and the appropriate interpolation property that these logic enjoy.
\end{abstract}

\section{Introduction}


\section{Dynamic Locales and Their Logic} \label{DynamicLocales}

\begin{dfn}
A locale $\mathscr{X}$ is a complete poset whose meet distributes over any arbitrary family of joins, i.e., $a \wedge \bigvee_{i \in I} b_i=\bigvee_{i \in I} (a \vee b_i)$, for any $a, b_i \in \mathscr{X}$. A localic map $f: \mathscr{X} \to \mathscr{Y}$ between two locales $\mathscr{X}$ and $\mathscr{Y}$ is a map preserving all finite meets and arbitrary joins. It is called an isomorphism if it has a converse as a localic map.
\end{dfn}

The canonical example of locales and the localic maps are the poset of the open subsets of a topological space and the inverse image of the continuous functions between spaces, respectively. In this sense, locales and the localic maps provide a point-free formalization for the topological discourse, focusing only on open subsets as the main ingredient of topology.

\begin{dfn}
Let $\mathscr{X}$ be a locale and $\nabla: \mathscr{X} \to \mathscr{X}$ be a localic map. Then $\mathcal{D}=(\mathscr{X}, \nabla)$ is called a dynamic locale. It is called invertible if $\nabla$ is an isomorphism.
\end{dfn}

Dynamic locales are the intuitionistic and simplified version of the dynamic topological spaces defined in \cite{}. Here, we force the formalization to restrict itself to the open subsets. However, to represent the non-elementary structure of dynamic locales in a syntactical elementary language, we need to capture the distributivity of meets over arbitrary joins and the fact that $\nabla$ preserves any arbitrary joins. The following easy observation helps:

\begin{thm}(Adjoint Functor Theorem for Posets) \label{AFT}
Let $\mathcal{A}$ and $\mathcal{B}$ be two complete posets and $f:\mathcal{A} \to \mathcal{B}$ be an order-preserving function. Then $f$ preserves arbitrary joins iff there exists an order-preserving function $g: \mathcal{B} \to \mathcal{A}$ such that
\[
f(a) \leq_{\mathcal{B}} b  \;\;\; \text{iff}  \;\;\; a \leq_{\mathcal{A}} g(b)
\]
This $g$ if exits is clearly unique and called the right adjoint of $f$.
\end{thm}
\begin{proof}
If there exists such $g$ then $f$ preserves all joins... For the other half, define $g(b)=\bigvee \{a \in \mathcal{A} | f(a) \leq_{\mathcal{B}} b \}$. One direction is obvious from the definition. The other is a consequence of the fact that $f$ preserves all joins.
\end{proof}

Using Theorem \ref{AFT} on a dynamic locale $\mathcal{D}=(\mathscr{X}, \nabla_{\mathcal{D}})$, we can observe that the facts that the maps $x \mapsto x \wedge a$ and $x \mapsto \nabla x$ preserve arbitrary joins, are representable by introducing their right adjoints into the language as the primitive connectives. For the former, the adjoint is nothing but the usual Heyting implication. For the latter, we could also add a unary operator to the language to represent the adjoint for $\nabla$. But instead we will introduce a binary connective $\rightsquigarrow$ (which will be useful later in section \ref{sec:ldls}), and define this adjoint as a special case $\Box A = \top \rightsquigarrow A$, representing the natural adjoint for $\nabla_\mathcal{D}$ denoted by $\Box_{\mathcal{D}}$, satisfying
\[
\nabla_{\mathcal{D}} a \leq_{\mathscr{X}} b  \;\;\; \text{iff}  \;\;\; a \leq_{\mathscr{X}} \Box_{\mathcal{D}} b
\]


In the following, we will define the logic of dynamic locales, denoted by $\mathbf{LDL}$. Let $\mathcal{L}$ be the usual language of propositional logic plus a modality $\nabla$ and an arrow $\rightsquigarrow$, i.e., $\mathcal{L}=\{\wedge, \vee, \to, \top, \bot, \nabla, \rightsquigarrow\}$. Define $\mathbf{LDL}$ as the logic of the sequent-style system defined by the following rules:
\begin{flushleft}
 \textbf{Axioms:}
\end{flushleft}
\begin{center}
 \begin{tabular}{c c c}
 \AxiomC{}
 \RightLabel{$Id$}
 \UnaryInfC{$ A \Rightarrow A$}
 \DisplayProof \;\;\;
 &
 \AxiomC{}
 \RightLabel{$Ta$}
 \UnaryInfC{$ \Rightarrow \top$}
 \DisplayProof\;\;\;
 &
 \AxiomC{}
 \RightLabel{$Ex$}
 \UnaryInfC{$ \bot \Rightarrow $}
 \DisplayProof
 \\[3ex]
\end{tabular}
\end{center}

\begin{flushleft}
 		\textbf{Structural Rules:}
\end{flushleft}

\begin{center}
 \begin{tabular}{c c c}
 \AxiomC{$ \Gamma \Rightarrow \Delta$}
 \RightLabel{$L w$}
 \UnaryInfC{$ \Gamma, A \Rightarrow \Delta$}
 \DisplayProof
 &
 \AxiomC{$ \Gamma \Rightarrow $}
\RightLabel{$R w$}
 \UnaryInfC{$\Gamma \Rightarrow A$}
 \DisplayProof
 &
 \AxiomC{$ \Gamma, A, A \Rightarrow \Delta$}
\RightLabel{$Lc$}
 \UnaryInfC{$\Gamma, A \Rightarrow \Delta$}
 \DisplayProof
  \\[3ex]
\end{tabular}
\end{center}

\begin{flushleft}
 		\textbf{Cut:}
\end{flushleft}
\begin{center}
  	\begin{tabular}{c}

		\AxiomC{$ \Gamma \Rightarrow A$}
		\AxiomC{$\Pi, A \Rightarrow \Delta$}
		\RightLabel{$cut$}
		\BinaryInfC{$ \Pi, \Gamma \Rightarrow \Delta$}
		\DisplayProof
		 \\[3ex]
		\end{tabular}
\end{center}

\begin{flushleft}
 \textbf{Conjunction Rules:}
\end{flushleft}
\begin{center}
 \begin{tabular}{c c c}
\AxiomC{$ \Gamma, A \Rightarrow \Delta$}
 \RightLabel{$L \wedge_1$}
 \UnaryInfC{$ \Gamma, A \wedge B \Rightarrow \Delta$}
 \DisplayProof
 &
 \AxiomC{$ \Gamma, B \Rightarrow \Delta$}
 \RightLabel{$L \wedge_2$}
 \UnaryInfC{$\Gamma, A \wedge B \Rightarrow \Delta$}
 \DisplayProof
	   		&
   		\AxiomC{$\Gamma \Rightarrow A$}
   		\AxiomC{$\Gamma \Rightarrow B$}
   		\RightLabel{$R \wedge$}
   		\BinaryInfC{$ \Gamma \Rightarrow A \wedge B $}
   		\DisplayProof
   			\\[3 ex]
\end{tabular}
\end{center}

\begin{flushleft}
 \textbf{Disjunction Rules:}
\end{flushleft}
\vspace{.001pt}
\begin{center}
 \begin{tabular}{c c c}
 \AxiomC{$ \Gamma, A \Rightarrow \Delta$}
 \AxiomC{$\Gamma, B \Rightarrow \Delta$}
 \RightLabel{$L \vee_1$}
 \BinaryInfC{$ \Gamma, A \vee B \Rightarrow \Delta$}
 \DisplayProof
 &
 \AxiomC{$\Gamma \Rightarrow A$}
 \RightLabel{$R \vee_2$}
 \UnaryInfC{$\Gamma \Rightarrow A \vee B$}
 \DisplayProof
 &
 \AxiomC{$\Gamma \Rightarrow B$}
 \RightLabel{$R \vee$}
 \UnaryInfC{$\Gamma \Rightarrow A \vee B$}
 \DisplayProof
 \\[3ex]
\end{tabular}
\end{center}

\begin{flushleft}
	\textbf{Implication Rules:}
 \end{flushleft}
 \vspace{.001pt}
 \begin{center}
	\begin{tabular}{c c c}
	\AxiomC{$ \Gamma \Rightarrow A$}
	\AxiomC{$\Gamma, B \Rightarrow \Delta$}
	\RightLabel{$L \rightarrow$}
	\BinaryInfC{$ \Gamma, A \rightarrow B \Rightarrow \Delta$}
	\DisplayProof
	&
	\AxiomC{$\Gamma , A \Rightarrow B$}
	\RightLabel{$R \rightarrow$}
	\UnaryInfC{$\Gamma \Rightarrow A \rightarrow B$}
	\DisplayProof
	\\[3ex]
 \end{tabular}
 \end{center}

\begin{flushleft}
  \textbf{$\nabla$ Rules:}
\end{flushleft}
\vspace{.001pt}
\begin{center}
 \begin{tabular}{c}
 \AxiomC{$\Gamma \Rightarrow A$}
 \RightLabel{$N$}
 \UnaryInfC{$\nabla \Gamma \Rightarrow \nabla A$}
 \DisplayProof
 \\[3ex]
\end{tabular}
\end{center}


\begin{flushleft}
	\textbf{Strict Implication Rules:}
 \end{flushleft}
 \vspace{.001pt}
 \begin{center}
	\begin{tabular}{c c}
	\AxiomC{$\Gamma \Rightarrow A$}
	\AxiomC{$\Gamma, B \Rightarrow \Delta$}
	\RightLabel{$L \rightsquigarrow$}
	\BinaryInfC{$\Gamma, \nabla (A \rightsquigarrow B) \Rightarrow \Delta$}
	\DisplayProof
	&
	\AxiomC{$\nabla \Gamma, A \Rightarrow B$}
	\RightLabel{$R \rightsquigarrow$}
	\UnaryInfC{$\Gamma \Rightarrow A \rightsquigarrow B$}
	\DisplayProof
	\\[3ex]
 \end{tabular}
 \end{center}

If we also add the following rules to the system we will have these variants of $\mathbf{LDL}$; \textbf{LDL(L)}, \textbf{LDL(R)}, \textbf{LDL(Fa)} and \textbf{LDL(Fu)} respectively.


\textbf{L}
\begin{prooftree}
	\RightLabel{$L$}
	\AXC{$\Gamma, A \Rightarrow \Delta$}
	\UIC{$\Gamma, \nabla A \Rightarrow \Delta$}
\end{prooftree}

\textbf{R}
\begin{prooftree}
	\RightLabel{$R'$}
	\AXC{$\nabla \Gamma, \Sigma \Rightarrow \Delta$}
	\UIC{$\Gamma, \Sigma \Rightarrow \Delta$}
\end{prooftree}

\textbf{Fa}
\begin{prooftree}
	\RightLabel{$Fa$}
	\AXC{$\Gamma , A \Rightarrow B$}
	\UIC{$\Gamma \Rightarrow \nabla(A \rightsquigarrow B)$}
\end{prooftree}

\textbf{Fu}
\begin{prooftree}
	\RightLabel{$Fu'$}
	\AXC{$\nabla \Gamma \Rightarrow \nabla A$}
	\UIC{$\Gamma \Rightarrow A$}
\end{prooftree}

From here on, we will refer to all these systems as \emph{extensions of} $\mathbf{LDL}$.

\begin{dfn}\label{t4-1}(Topological Semantics)
Let $\mathcal{D}=(\mathscr{X}, \nabla_{\mathcal{D}})$ be a dynamic locale and $V:\mathcal{L} \to\mathscr{X}$ be an assignment. A tuple $(\mathcal{D}, V)$ is called a topological model if:
\begin{itemize}
\item[$\bullet$]
$V(\top)=1$ and $V(\bot)=0$,
\item[$\bullet$]
$V(A \wedge B)=V(A) \wedge V(B)$,
\item[$\bullet$]
$V(A \vee B)=V(A) \vee V(B)$,
\item[$\bullet$]
$V(A \rightarrow B)= V(A) \rightarrow V(B)$.
\item[$\bullet$]
$V(A \rightsquigarrow B)= \Box_{\mathcal{D}} (V(A) \rightarrow V(B))$,
\item[$\bullet$]
$V(\nabla A)=\nabla_{\mathcal{D}} V(A)$.
\end{itemize}
We say $(\mathcal{D}, V) \vDash \Gamma \Rightarrow \Delta$ when $\bigwedge_{\gamma \in \Gamma} V(\gamma) \leq \bigvee_{\delta \in \Delta} V(\delta)$ and $\mathcal{D} \vDash \Gamma \Rightarrow \Delta$ when for all $V$, $(\mathcal{D}, V) \vDash \Gamma \Rightarrow \Delta$.
\end{dfn}

\begin{thm}\label{t4-2}(Soundness-Completeness) $ \mathbf{LDL} \vdash \Gamma \Rightarrow \Delta$ iff $\mathcal{D} \vDash \Gamma \Rightarrow \Delta$, for any dynamic locale $\mathcal{D}$.


\end{thm}
\begin{proof}
Basically refer to \cite{Amir}.
\end{proof}

\subsection{Kripke Models} \label{KripkeModels}

\begin{dfn}
By a Kripke model for the language $\mathcal{L}$, we mean a tuple $\mathcal{K}=(W, \leq, R, V)$ where $(W, \leq)$ is a poset, $R \subseteq W \times W$ is a relation over $W$ (not necessarily transitive or reflexive) compatible with $\leq$, i.e., for all $u, u', v, v' \in W$ if $(u, v) \in R$ and $u' \leq u$ and $v \leq v'$ then $(u', v') \in R$ and $V: At(\mathcal{L}) \to U((W, \leq))$, where $At(\mathcal{L})$ is the set of atomic formulas of $\mathcal{L}$ and $U((W, \leq))$ is the set of all upsets of $(W, \leq)$. Define the forcing relation as usual using the relation $\leq$ for the intuitionistic implication and $R$ for $\rightsquigarrow$, and for the $\nabla$ let $u \Vdash \nabla A$ if there exists $v \in W$ such that $(v, u) \in R$ and $v \Vdash A$. A Kripke model is called normal if there exists an order preserving function $\pi : W \to W$ such that $(u, v) \in R$ iff $u \leq \pi(v)$. It is clear that if this $\pi$ exists, it would be unique. Finally, a sequent $\Gamma \Rightarrow \Delta$ is valid in a Kripke model if for all $w \in W$, $w \Vdash \bigwedge \Gamma$ implies $w \Vdash \bigvee \Delta$.
\end{dfn}

\begin{thm}(Soundness-Completeness) The logic $\mathbf{LDL}$ is sound and complete with respect to all normal Kripke models.
\end{thm}

\subsection{The Fragment $\mathbf{LDL}_{\rightsquigarrow}$}\label{sec:ldls}
In this subsection we will introduce the implication-free fragment of the logic $\mathbf{LDL}$. To explain why we find this fragment interesting, let us begin with a formalization for a general notion of implication, introduced in \cite{Amir}:
\begin{dfn}
Let $\mathcal{A}=(A, \leq, \wedge, 1)$ be a meet semi-lattice. A map $\rightsquigarrow : A^{op} \times A \to A$ is called a meet-internalizing implication if:
\begin{itemize}
\item[$\bullet$]
$a \rightsquigarrow a=1$, for any $a \in A$.
\item[$\bullet$]
$(a \rightsquigarrow b) \wedge (b \rightsquigarrow c) \leq (a \rightsquigarrow c)$, for any $a, b, c \in A$.
\item[$\bullet$]
$(a \rightsquigarrow b) \wedge (a \rightsquigarrow c)= a \rightsquigarrow (b \wedge c)$, for any $a, b, c \in A$.
\end{itemize}
The tuple $(A, \leq, \wedge, 1, \rightsquigarrow)$ is called a meet-internalizing strong algebra. An embedding from a meet-internalizing strong algebra $(A, \leq_A, \wedge_A, 1_A, \rightsquigarrow_A)$ to another meet-internalizing strong algebra $(B, \leq_B, \wedge_B, 1_B, \rightsquigarrow_B)$ is a map $i : A \to B$, preserving all structures such that if $i(a) \leq_B i(b)$ then $a \leq_A b$.
\end{dfn}
The main source to produce these implications is dynamic locales. Let $\mathcal{D}=(\mathscr{X}, \nabla)$ be a dynamic locale. It is not hard to show that the operator $\rightsquigarrow$ defined as $A \rightsquigarrow B = \Box (A \rightarrow B)$ (where $\Box$ is the right adjoint for $\nabla$) is a meet-internalizing implication. Denote this meet-internalizing strong algebra by $\mathcal{A}(\mathcal{D})$. The following theorem, proved in \cite{Amir}, shows that this example is essentially the only example we may have:
\begin{thm}(Representation theorem)
Let $\mathcal{A}=(A, \wedge, \rightsquigarrow)$ be a meet-internalizing strong algebra. Then there exists a dynamic locale $\mathcal{D}=(\mathscr{X}, \nabla)$ and an embedding $i: \mathcal{A} \to \mathcal{A}(\mathcal{D})$.
\end{thm}

This representation theorem justifies focusing on the fragment of $\mathbf{LDL}$, where the implication $\rightsquigarrow$ is present and the usual intuitionistic implication is both omitted. Note that the representation theorem implies that the study of such a fragment is actually the study of all possible meet-internalizing implications. It is also possible to omit the modality $\nabla$ to have a more faithful syntax for implications. This is an established approach in sub-intuitionistic logic community. However, the draw back here is that in the absence of $\nabla$, the implication becomes proof-theoretically ill-behaved.

\begin{dfn} [$\mathbf{LDL}_{\rightsquigarrow}$]
	The fragment $\mathbf{LDL}_{\rightsquigarrow}$ of $\mathbf{LDL}$ is the system defined over the language $\mathcal{L}$, consisting of the same axioms and rules of $\mathbf{LDL}$ except the implication rules. 
	$\mathbf{LDL}_\rightsquigarrow$ also can be extended by augmenting the system with any of the rules $L$, $R$, $Fa$ and $Fu$. So we will refer to all these systems (including $\mathbf{LDL}$ and its extensions defined above) simply as \emph{extensions of} $\mathbf{LDL}_\rightsquigarrow$.
\end{dfn}

\begin{thm}
The systems $\mathbf{LDL}$ is conservative extensions of the systems $\mathbf{LDL}_{\rightsquigarrow}$.
\end{thm}
\begin{proof}
Write the easier part. The harder part must be essentially to completeness theorems of \cite{Amir}.
\end{proof}


\section{Proof Theory of $\mathbf{LDL}$ and $\mathbf{LDL}_{\rightsquigarrow}$}

\subsection{Sequent-style Systems}
In this section we will introduce two slightly modified systems $\mathbf{LDL}^*$ and $\mathbf{LDL}_{\rightsquigarrow}^*$, equivalent to $\mathbf{LDL}$ and $\mathbf{LDL}_{\rightsquigarrow}$ respectively. Their advantage is that they are, as it will be shown, cut-free.

Define $\mathbf{LDL}^*$ on the language $\mathcal{L}$, as the logic of the sequent-style system define by the same rules of $\mathbf{LDL}$, except that the rules $Ex$, $L\wedge_1$, $L\wedge_2$, $L\vee$, $L\rightarrow$, $L\rightsquigarrow$ and $N$ are replaced by the following generalized rules respectively.

	 \begin{center}
		\begin{tabular}{c}
		\AxiomC{}
		\RightLabel{$Ex$}
		\UnaryInfC{$\nabla^n \bot \Rightarrow$}
		\DisplayProof
		\\[3ex]
	 \end{tabular}
	 \end{center}

	 \begin{center}
		\begin{tabular}{c c}
	 \AxiomC{$\Gamma, \nabla^n A \Rightarrow \Delta$}
		\RightLabel{$L \wedge_1$}
		\UnaryInfC{$\Gamma, \nabla^n (A \wedge B) \Rightarrow \Delta$}
		\DisplayProof
		&
		\AxiomC{$ \Gamma, \nabla^n B \Rightarrow \Delta$}
		\RightLabel{$L \wedge_2$}
		\UnaryInfC{$\Gamma, \nabla^n (A \wedge B) \Rightarrow \Delta$}
		\DisplayProof
		\\[3 ex]
	 \end{tabular}
	 \end{center}

	 \vspace{.001pt}
	 \begin{center}
		\begin{tabular}{c}
		\AxiomC{$\Gamma, \nabla^n A \Rightarrow \Delta$}
		\AxiomC{$\Gamma, \nabla^n B \Rightarrow \Delta$}
		\RightLabel{$L \vee$}
		\BinaryInfC{$\Gamma, \nabla^n (A \vee B) \Rightarrow \Delta$}
		\DisplayProof
		\\[3ex]
	 \end{tabular}
	 \end{center}

	 \vspace{.001pt}
	 \begin{center}
		\begin{tabular}{c c}
		\AxiomC{$ \Gamma \Rightarrow \nabla^n A$}
		\AxiomC{$\Gamma, \nabla^n B \Rightarrow \Delta$}
		\RightLabel{$L \rightarrow$}
		\BinaryInfC{$ \Gamma, \nabla^n (A \rightarrow B) \Rightarrow \Delta$}
		\DisplayProof
		\\[3ex]
	 \end{tabular}
	 \end{center}

	 \begin{prooftree}
		\AXC{$\Gamma \Rightarrow \nabla^n A$}
		\AXC{$\Gamma, \nabla^n B \Rightarrow \Delta$}
		\RightLabel{$L \rightsquigarrow$}
		\BIC{$\Gamma, \nabla^{n+1} (A \rightsquigarrow B) \Rightarrow \Delta$}
	\end{prooftree}	

	 \vspace{.001pt}
	 \begin{center}
		\begin{tabular}{c}
		\AxiomC{$\Gamma \Rightarrow \Delta$}
		\RightLabel{$N$}
		\UnaryInfC{$\nabla \Gamma \Rightarrow \nabla \Delta$}
		\DisplayProof
		\\[3ex]
	 \end{tabular}
	 \end{center}

Similarly for $\mathbf{LDL}_{\rightsquigarrow}$, the equivalent but cut-free logic $\mathbf{LDL}^*_{\rightsquigarrow}$ is defined by dropping the implication rules from $\mathbf{LDL}^*$. For both $\mathbf{LDL}^*$ and $\mathbf{LDL}_\rightsquigarrow$ we can also define extensions by adding any of the rules $L$, $R$, $Fa$ or $Fu$.

The following lemmas are used in their subsequent theorem, which shows that the cut-free systems have exactly the same power as their original counterparts.
Observe that the the proof-trees in lemmas \ref{lem:l-nabla-dist-and}-\ref{lem:l-nabla-dist-si} are constructible in $\mathbf{LDL}_\rightsquigarrow$ or any of its extensions (including $\mathbf{LDL}$ and its extensions). So we denote any of these systems by a placeholder $\mathbf{LDL}_\rightsquigarrow(\star)$ for the sake of brevity. In lemma \ref{lem:l-nabla-dist-imp}, the same goes for $\mathbf{LDL}$ and its extensions, which are denoted by $\mathbf{LDL}(\star)$. We will also use the same notation later to refer to these systems for short. But notice that wherever there are more than one of these notations in a statement, like in \ref{thm:ldl-eq-ldls}-\ref{thm:ldls-cut-elim}, we are talking about the same system everywhere. So treat $\star$ as some variable ranging over the set $\{L\rightarrow, R\rightarrow, L, R, Fa, Fu\}$ (taking $\mathbf{LDL}$ as $\mathbf{LDL}_\rightsquigarrow(L\rightarrow,R\rightarrow)$).


\begin{lem}\label{lem:l-nabla-dist-and} For all $n > 0$, $\mathbf{LDL}_\rightsquigarrow(\star) \vdash \nabla^n (A \land B) \Rightarrow \nabla^n A \land \nabla^n B$.
\end{lem}
\begin{proof}\quad
	\begin{prooftree}
		\AXC{}
		\RightLabel{$Id$}
		\UIC{$A \Rightarrow A$}
		\RightLabel{$L\land_1$}
		\UIC{$A \land B \Rightarrow A$}
		\RightLabel{$N$} \doubleLine
		\UIC{$\nabla^n (A \land B) \Rightarrow \nabla^n A$}

		\AXC{}
		\RightLabel{$Id$}
		\UIC{$B \Rightarrow B$}
		\RightLabel{$L\land_2$}
		\UIC{$A \land B \Rightarrow B$}
		\RightLabel{$N$} \doubleLine	
		\UIC{$\nabla^n (A \land B) \Rightarrow \nabla^n B$}
		
		\RightLabel{$R\land$}
		\BIC{$\nabla^n (A \land B) \Rightarrow \nabla^n A \land \nabla^n B$}
	\end{prooftree}
\end{proof}

\begin{lem} \label{lem:l-nabla-box} $\mathbf{LDL}_\rightsquigarrow(\star) \vdash \nabla (\top \rightsquigarrow A) \Rightarrow A$.
\end{lem}
\begin{proof}\quad
	\begin{prooftree}
		\AXC{}
		\RightLabel{$Ta$}
		\UIC{$\Rightarrow \top$}
	
		\AXC{}
		\RightLabel{$Id$}
		\UIC{$A \Rightarrow A$}
	
		\RightLabel{$L\rightsquigarrow$}
		\BIC{$\nabla (\top \rightsquigarrow A) \Rightarrow A$}
	\end{prooftree}
\end{proof}

\begin{lem}\label{lem:l-box-nabla} $\mathbf{LDL}_\rightsquigarrow(\star) \vdash A \Rightarrow \top \rightsquigarrow \nabla A$.
\end{lem}
\begin{proof}\quad
	\begin{prooftree}
		\AXC{}
		\RightLabel{$Id$}
		\UIC{$\nabla A \Rightarrow \nabla A$}
		
		\RightLabel{$Lw$}
		\UIC{$\nabla A , \top \Rightarrow \nabla A$}

		\RightLabel{$R\rightsquigarrow$}
		\UIC{$A \Rightarrow \top \rightsquigarrow \nabla A$}
	\end{prooftree}
\end{proof}

\begin{lem}\label{lem:l-nabla-dist-or} $\mathbf{LDL}_\rightsquigarrow(\star) \vdash \nabla (A \lor B) \Rightarrow \nabla A \lor \nabla B$.
\end{lem}
\begin{proof} Let $\mathcal{D}$ be a proof-tree we can construct for $\nabla (\top \rightsquigarrow (\nabla A \lor \nabla B)) \Rightarrow \nabla A \lor \nabla B$ from lemma \ref{lem:l-nabla-box}.

	\begin{prooftree}
		\AXC{}
		\RightLabel{$Id$}
		\UIC{$\nabla A \Rightarrow \nabla A$}
		\RightLabel{$R\lor_1$}
		\UIC{$\nabla A \Rightarrow \nabla A \lor \nabla B$}
		\RightLabel{$Lw$}
		\UIC{$\nabla A , \top \Rightarrow \nabla A \lor \nabla B$}
		\RightLabel{$R\rightsquigarrow$}
		\UIC{$A \Rightarrow \top \rightsquigarrow (\nabla A \lor \nabla B)$}

		\AXC{}
		\RightLabel{$Id$}
		\UIC{$\nabla B \Rightarrow \nabla B$}
		\RightLabel{$R\lor_2$}
		\UIC{$\nabla B \Rightarrow \nabla A \lor \nabla B$}
		\RightLabel{$Lw$}
		\UIC{$\nabla B , \top \Rightarrow \nabla A \lor \nabla B$}
		\RightLabel{$R\rightsquigarrow$}
		\UIC{$B \Rightarrow \top \rightsquigarrow (\nabla A \lor \nabla B)$}

		\RightLabel{$L\lor$}
		\BIC{$A \lor B \Rightarrow \top \rightsquigarrow (\nabla A \lor \nabla B)$}
		\RightLabel{$N$}
		\UIC{$\nabla (A \lor B) \Rightarrow \nabla (\top \rightsquigarrow (\nabla A \lor \nabla B))$}

		\AXC{$\mathcal{D}$}

		\RightLabel{$Cut$}
		\BIC{$\nabla (A \lor B) \Rightarrow \nabla A \lor \nabla B$}
	\end{prooftree}
\end{proof}

\begin{lem}\label{lem:l-nabla-n-dist-or} For all $n > 0$, $\mathbf{LDL}_\rightsquigarrow(\star) \vdash \nabla^n (A \lor B) \Rightarrow \nabla^n A \lor \nabla^n B$.
\end{lem}
\begin{proof} Let $\mathcal{D}_1$ be the proof-tree of lemma \ref{lem:l-nabla-dist-or}, which proves the case for $n = 1$. For any $n > 1$ we have

	\begin{prooftree}
		\AXC{$\mathcal{D}_{n-1}$}
		\noLine
		\UIC{$\nabla^{n-1} (A \lor B) \Rightarrow \nabla^{n-1} A \lor \nabla^{n-1} B$}
		\RightLabel{$N$}
		\UIC{$\nabla^n (A \lor B) \Rightarrow \nabla (\nabla^{n-1} A \lor \nabla^{n-1} B)$}

		\AXC{$\mathcal{D}_1$}
		\noLine
		\UIC{$\nabla (\nabla^{n-1} A \lor \nabla^{n-1} B) \Rightarrow \nabla^n A \lor \nabla^n B$}
		
		\RightLabel{$Cut$} \LeftLabel{$\mathcal{D}_n:$}
		\BIC{$\nabla^n (A \lor B) \Rightarrow \nabla^n A \lor \nabla^n B$}
	\end{prooftree}
\end{proof}

\begin{lem}\label{lem:l-nabla-bot} $\mathbf{LDL}_\rightsquigarrow(\star) \vdash \nabla \bot \Rightarrow \bot$.
\end{lem}
\begin{proof} Let $\mathcal{D}$ be a proof-tree for $\nabla (\top \rightsquigarrow \bot) \Rightarrow \bot$ which we have by lemma \ref{lem:l-nabla-box}.
	\begin{prooftree}
		\AXC{}
		\RightLabel{$Ex$}
		\UIC{$\bot \Rightarrow$}
		\RightLabel{$Rw$}
		\UIC{$\bot \Rightarrow \top \rightsquigarrow \bot$}
		\RightLabel{$N$}
		\UIC{$\nabla \bot \Rightarrow \nabla (\top \rightsquigarrow \bot)$}

		\AXC{$\mathcal{D}$}

		\RightLabel{$Cut$}
		\BIC{$\nabla \bot \Rightarrow \bot$}
	\end{prooftree}	
\end{proof}

\begin{lem}\label{lem:l-nabla-n-bot} For $n > 0$, $\mathbf{LDL}_\rightsquigarrow(\star) \vdash \nabla^n \bot \Rightarrow \bot$.
\end{lem}
\begin{proof} We will prove a stronger version: For $n \geq m > 0$, $\mathbf{LDL} \vdash \nabla^n \bot \Rightarrow \nabla^{n-m} \bot$. Let $\mathcal{D}_1$ be the proof-tree of lemma \ref{lem:l-nabla-bot} which handles $n = m = 1$. Using induction om $m$, and denoting by IH the proof-tree for $\nabla^n \bot \Rightarrow \nabla^{n-(m-1)} \bot$ from the induction hypothesis, we have for $n > 1$
	\begin{prooftree}
		\AXC{IH}
		\noLine
		\UIC{$\nabla^n \bot \Rightarrow \nabla^{n-(m-1)} \bot$}

		\AXC{$\mathcal{D}_1$}
		\noLine
		\UIC{$\nabla \bot \Rightarrow \bot$}
		\doubleLine \RightLabel{$N^{(n-m)}$}
		\UIC{$\nabla^{n-(m-1)} \bot \Rightarrow \nabla^{n-m} \bot$}

		\RightLabel{$Cut$}
		\BIC{$\nabla^n \bot \Rightarrow \nabla^{n-m} \bot$}
	\end{prooftree}
\end{proof}

\begin{lem}\label{lem:l-nabla-dist-si} For any $n > 0$, $\mathbf{LDL}_{\rightsquigarrow}(\star) \vdash \nabla^n (A \rightsquigarrow B) \Rightarrow \nabla^n A \rightsquigarrow \nabla^n B$.
\end{lem}
\begin{proof}\quad
	\begin{prooftree}
		\AXC{}
		\RightLabel{$Id$}
		\UIC{$A \Rightarrow A$}
		
		\AXC{}
		\RightLabel{$Id$}
		\UIC{$B \Rightarrow B$}
		\RightLabel{$Lw$}
		\UIC{$A , B \Rightarrow B$}
		
		\RightLabel{$L\rightsquigarrow$}
		\BIC{$\nabla (A \rightsquigarrow B) , A \Rightarrow B$}
		\RightLabel{$N^{(n)}$} \doubleLine
		\UIC{$\nabla^{n+1} (A \rightsquigarrow B) , \nabla^n A \Rightarrow \nabla^n B$}
		\RightLabel{$R\rightsquigarrow$}
		\UIC{$\nabla^n (A \rightsquigarrow B) \Rightarrow \nabla^n A \rightsquigarrow \nabla^n B$}
	\end{prooftree}
\end{proof}


\begin{lem}\label{lem:l-nabla-dist-imp} For any $n > 0$, $\mathbf{LDL}(\star) \vdash \nabla^n (A \rightarrow B) \Rightarrow \nabla^n A \rightarrow \nabla^n B$.
\end{lem}
\begin{proof}\quad
	\begin{prooftree}
		\AXC{}
		\RightLabel{$Id$}
		\UIC{$A \Rightarrow A$}
	
		\AXC{}
		\RightLabel{$Id$}
		\UIC{$B \Rightarrow B$}
		\RightLabel{$Lw$}
		\UIC{$A , B \Rightarrow B$}
	
		\RightLabel{$L\rightarrow$}
		\BIC{$A \rightarrow B , A \Rightarrow B$}
		\RightLabel{$N^{(n)}$} \doubleLine
		\UIC{$\nabla^n (A \rightarrow B) , \nabla^n A \Rightarrow \nabla^n B$}
		\RightLabel{$R\rightarrow$}
		\UIC{$\nabla^n (A \rightarrow B) \Rightarrow \nabla^n A \rightarrow \nabla^n B$}
	\end{prooftree}
\end{proof}

In the rest of this section, by the \emph{length of a proof-tree} $\mathcal{D}$, denoted by $h(\mathcal{D})$, we mean the number of rule instances in its longest branch.

The theorem below shows that the original systems (and their extensions) deduce exactly the same sequents as the cut-free systems (and their extensions).

\begin{thm}\label{thm:ldl-eq-ldls}
	For any sequent $\Gamma \Rightarrow \Delta$ in the language $\mathcal{L}$, $\mathbf{LDL}_\rightsquigarrow(\star) \vdash \Gamma \Rightarrow \Delta$ iff $\mathbf{LDL}_\rightsquigarrow^*(\star) \vdash \Gamma \Rightarrow \Delta$.
\end{thm}
\begin{proof}
	One direction easily follows from the fact that all rules of $\mathbf{LDL}_\rightsquigarrow(\star)$ are just instances of $\mathbf{LDL}_\rightsquigarrow^*(\star)$'s rules.
	For the other direction, we will use case analysis for the last rule in the proof-tree of $\Gamma \Rightarrow \Delta$ in $\mathbf{LDL}_\rightsquigarrow^*(\star)$, which we call $\mathcal{D}$, and construct a proof-tree for it in $\mathbf{LDL}_\rightsquigarrow(\star)$ in each case.
	
	First observe that $Id$ and $Ta$ are present in $\mathbf{LDL}_\rightsquigarrow(\star)$ and lemma \ref{lem:l-nabla-n-bot} handles the $Ex$ case.
	For the other rules, use induction on the length of $\mathcal{D}$; the induction hypothesis will provide a proof-tree in $\mathbf{LDL}_\rightsquigarrow(\star)$ for the sub-tree(s) of $\mathcal{D}$.
	For the rules that are common between two systems (or their extensions), just apply the same rule (in $\mathbf{LDL}_\rightsquigarrow(\star)$) on the proof-tree(s) from the induction hypothesis to reach the desired sequent. For example, if $\mathcal{D}$ ends with $R\vee$, then just apply $R\vee$ (in $\mathbf{LDL}_\rightsquigarrow(\star)$) on the proof-tree that we get from the induction hypothesis.
	In cases of $\mathbf{LDL}_\rightsquigarrow^*(\star)$'s stronger rules, i.e. $L\land_1$, $L\land_2$, $L\lor$, $L\rightarrow$ and $L\rightsquigarrow$, do the same, and also $cut$ the sequents proved in lemmas \ref{lem:l-nabla-dist-and}, \ref{lem:l-nabla-dist-or}, \ref{lem:l-nabla-dist-imp} or \ref{lem:l-nabla-dist-si} into the resulting sequent.
	The case for $N$ divides to two further cases. One case is when $\Delta = A$ for some formula $A$, which is again handled by applying $N$ on the sequent from the induction hypothesis.
	The other case is when $\Delta = \{\}$, so we have $\Gamma \Rightarrow$ from induction hypothesis, on the right of which we first introduce $\bot$ using $Rw$, and then apply $N$.
	Then we can $cut$ it into the sequent proved in lemma \ref{lem:l-nabla-bot}, and then into $Ex$, to derive $\nabla \Gamma \Rightarrow$ as was desired.
\end{proof}

\subsection{Cut-elimination theorems}
Although the admissibility of cut in $\mathbf{LDL}^*_\rightsquigarrow(\star)$ does not imply it's admissibility in $\mathbf{LDL}_\rightsquigarrow(\star)$, but as we will see, their equivalence---by theorem \ref{thm:ldl-eq-ldls}---enables us to prove statements about the cut-free system, which are otherwise not provable in the presence of the cut rule, and then translate the result back into statements about the original system.

For technical reasons, we will eliminate a stronger form of the cut rule, which nevertheless satisfies our goal here.
\begin{dfn}[$\nabla Cut$ rule]\label{def:n-cut} We denote by $\mathbf{LDL}^M_\rightsquigarrow(\star)$ the same systems defined by $\mathbf{LDL}^*_\rightsquigarrow(\star)$, except that the $Cut$ rule is replaced by the following generalization:
\begin{prooftree}
	\AXC{$\Gamma \Rightarrow \nabla^m A$}
	\AXC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow \Delta$}
	\RightLabel{$\nabla Cut$}
	\BIC{$\{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma \Rightarrow \nabla^m \Delta$}
\end{prooftree}
where $\nabla^n$ means $\nabla$ applied $n$ times, $\{\nabla^{n_i} A\}$ means $\{\nabla^{n_0} A,\dotsb, \nabla^{n_l} A\}$ and $\{\nabla^{n_i} \Gamma\}$ means $\bigcup_{A \in \Gamma} \{\nabla^{n_i} A\}$ for some sequence of natural numbers $n_i$ of length $l+1$.
We call $A$ the \emph{cut-formula} and for convenience, will refer to members of $\{\nabla^m A\} \cup \{\nabla^{n_i} A\}$ as \emph{cut-burden}. We will also denote by the tuple $(A, m, \{n_i\})$, the \emph{cut-data} of such instance.
\end{dfn}

\begin{cor}\label{cor:mc-riddance} Any sequent provable in $\mathbf{LDL}^*_\rightsquigarrow(\star)$ is also provable in $\mathbf{LDL}^M_\rightsquigarrow(\star)$. Indeed we can just replace any instance of $Cut$ with similar instance of $\nabla Cut$, with $m = 0$ and $n_i = (0)$.
\end{cor}

Next, we should define a measure for cut-complexity for formulas, and then extend it to rule instances and proof-trees.

\begin{dfn}[Rank]
	Rank of a formula $A$ is defined as
	\[ \rho(A) = \begin{cases}
	1 & \quad ; A \in P \cup \{ \bot, \top \} \\
	\rho(B) & \quad ; A = \nabla B \\
	max(\rho(B), \rho(C)) + 1 & \quad ; A = B \circ C, \circ \in \{ \land, \lor, \rightarrow, \rightsquigarrow \}
	\end{cases} \]
	Notice that $\nabla$ does not increase the rank of a formula.
	
	We also define rank for rule instances and proof-trees as follows. Rank of a rule instance is the rank of its cut-formula if it is an instance of the $\nabla Cut$ rule, and $0$ if it's not.
	For a proof tree $\mathcal{D}$, $\rho(\mathcal{D})$ is the maximum rank of all of its rule instances.
\end{dfn}

The following lemma will help handling of a case in the main theorem.

\begin{lem}\label{lem:ldls-top-redundant} If $\mathbf{LDL}^M_\rightsquigarrow(\star)$ proves $\Gamma , \{\nabla^{n_i} \top\} \Rightarrow \Delta$, then it also proves $\Gamma \Rightarrow \Delta$ with a proof-tree of at most the same rank.
\end{lem}
\begin{proof}
Suppose $\mathcal{D}$ is a proof-tree for $\Gamma , \{\nabla^{n_i} \top\} \Rightarrow \Delta$ in $\mathbf{LDL}^M(\star)$ and consider different cases for the last rule of $\mathcal{D}$ with possible sub-trees $\mathcal{D}_0$ and $\mathcal{D}_1$.
By induction on $\mathcal{D}$ we can assume that the theorem holds for $\mathcal{D}_0$ and $\mathcal{D}_1$.
First observe that $Ta$ and $Ex$ cases are trivially ruled out. In $Id$ case, which implies $\{\nabla^{n_i} \top\} = \nabla^n \top$ for some $n$, we have $\Rightarrow \nabla^n \top$ by $n$ times applications of $N$ on $Ta$. In $Lw$ case, where $\{\nabla^{n_i} \top\} = \nabla \top$ and it is principal, $\mathcal{D}_0$ itself proves the desired sequent. If $\{\nabla^{n_i} \top\}$ has more members, then the induction hypothesis gives the desired sequent. The cases for $Lc$ or $L$ on some $\nabla^{n_j} \top$ are similar. In all other cases, just apply induction hypothesis on $\mathcal{D}_0$ (and possibly $\mathcal{D}_1$), then the same last rule. Notice that $\nabla Cut$ is not used except in $\nabla Cut$ case, where it is applied with the same cut-formula, so the resulting proof tree will not be of a higher rank than $\mathcal{D}$.
The proof for $\mathbf{LDL}^M_{\rightsquigarrow}(\star)$ is similar, except that there are no cases $\rightarrow$.
\end{proof}

The following theorem shows that we can imitate any instance of the cut rule in a proof-tree of lower rank.

\begin{thm}\label{thm:ldls-cut-reduction}[Cut Reduction]
If $\mathbf{LDL}^M_\rightsquigarrow(\star)$ proves $\Gamma \Rightarrow \nabla^m A$ and\\\ $\Sigma , \{\nabla^{n_i} A\} \Rightarrow \Delta$ with proof trees of ranks less than $\rho(A)$, then it also proves $\{\nabla^{n_i} \Gamma\} , \nabla^m\Sigma \Rightarrow \nabla^m\Delta$ also with a proof tree of a rank less than $\rho(A)$.
\end{thm}
\begin{proof}
	We have two proof-trees
  \[
    {\mathcal{D}_0
    \atop
    \Gamma \Rightarrow \nabla^m A}
    \hspace{3em}
    {\mathcal{D}_1
    \atop
    \Sigma , \{\nabla^{n_i} A\} \Rightarrow \Delta}
  \]
  both of a lower rank than that of $A$, and we want to construct a proof-tree
  \[\mathcal{D} \atop \{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma \Rightarrow \nabla^m \Delta \]
  without increasing the cut rank.

	The construction takes place in different cases for the last rule that occurs in $\mathcal{D}_0$ and $\mathcal{D}_1$. Notice that proof of the theorem is essentially the same for all systems, modulo the cases that are specific to each system. Thus, the cases which are common between all systems are not repeated for the sake of brevity.

	Also notice that in some cases our construction would depend only on the last rule of one of the sub-trees, i.e. it would work no matter what the last rule in $\mathcal{D}_1$ is. so it will cover all the cases for the other sub-tree. In other cases, which are the cases that the cut-formula is altered on both sides, the last rule in one sub-tree determines a specific form for the cut-formula, which in turn determines the last rule of the other sub-tree.


	First, construct the desired proof-tree in the cases that $\mathcal{D}_0$ is an axiom, independent of $\mathcal{D}_1$. The case for $Id$ is trivial, $Ex$ won't happen and $Ta$ is handled by lemma \ref{lem:ldls-top-redundant}.

  In rest of the cases, we will use induction on the length of both $\mathcal{D}_0$ and $\mathcal{D}_1$ as follows; For any two proof-trees $\mathcal{D}_0'$ and $\mathcal{D}_1'$ such that $h(\mathcal{D}_0') + h(\mathcal{D}_1') < h(\mathcal{D}_0) + h(\mathcal{D}_1)$, where $\mathcal{D}_0'$ proves $\Gamma' \Rightarrow \nabla^{m'} A'$ and $\mathcal{D}_1'$ proves $\Sigma', \{\nabla^{n'_i} A'\} \Rightarrow \Delta'$ for arbitrary $\Gamma'$, $\Sigma'$, $\Delta'$, $A'$, $m'$ and $n_i'$, for which we have $\rho(\mathcal{D}_0'),\mathcal{D}_1' < \rho(A')$, the induction hypothesis give us a proof-tree, denoted by $\text{IH}(\mathcal{D}_0', \mathcal{D}_1')$ where it matters, that proves $\{\nabla^{n_i'}\Gamma'\}, \nabla^{m'} \Sigma' \Rightarrow \nabla^{m'} \Delta'$, and we also have $\rho(\text{IH}(\mathcal{D}_0', \mathcal{D}_1')) < \rho(A')$.


	Assume $\mathcal{D}_0$ ends with an instance of any of the rules $Lw$, $Lc$, $L\land_1$, $L\land_2$, $L\lor$, $L\rightarrow$, $L\rightsquigarrow$, $\nabla Cut$, $N$, $Fu'$, $L$ or $R'$, again independent of $\mathcal{D}_1$. In all these cases, it suffices to use induction on the assumption(s) of this rule to remove the cut-burden from both sub-trees. Then, we can apply the same rule to get the desired sequent. Here we will only mention the cases for $L\wedge_1$, $L\vee$, $L\rightsquigarrow$, $\nabla Cut$, $N$ and $Fu'$, the last three of which may be of special concern, since they also alter the cut-burden. The other cases are similar.

	$L\wedge_1$: If $\mathcal{D}_0$ ends with $L\wedge_1$, that is
	\begin{prooftree}
		\noLine
		\AXC{$\mathcal{D}_0'$}
		\UIC{$\Gamma, \nabla^r B \Rightarrow \nabla^m A$}
		
		\RightLabel{$L\wedge_1$}
		\UIC{$\Gamma, \nabla^r (B \wedge C) \Rightarrow \nabla^m A$}
 \end{prooftree}
 then by applying $L\wedge_1$ on what we get from induction
 \begin{prooftree}
	\noLine
	\AXC{$\mathcal{D}_0'$}
	\UIC{$\Gamma, \nabla^r B \Rightarrow \nabla^m A$}
	
	\noLine
	\AXC{$\mathcal{D}_1$}
	\UIC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow \Delta$}
	
	\RightLabel{IH}
	\BIC{$\{\nabla^{n_i} \Gamma, \nabla^{n_i+r} B\}, \nabla^m \Sigma \Rightarrow \nabla^m \Delta$}

	\RightLabel{$L\wedge_1$} \doubleLine
	\UIC{$\{\nabla^{n_i} \Gamma, \nabla^{n_i+r} (B \wedge C)\}, \nabla^m \Sigma \Rightarrow \nabla^m \Delta$}
 \end{prooftree}

 \noindent $L\vee$: If $\mathcal{D}_0$ ends with $L\vee$
	 \begin{prooftree}
		 \noLine
		 \AXC{$\mathcal{D}_0'$}
		 \UIC{$\Gamma, \nabla^r B \Rightarrow \nabla^m A$}
		 
		 \noLine
		 \AXC{$\mathcal{D}_0''$}
		 \UIC{$\Gamma, \nabla^r C \Rightarrow \nabla^m A$}
		 
		 \RightLabel{$L\vee$}
		 \BIC{$\Gamma, \nabla^r (B \vee C) \Rightarrow \nabla^m A$}
	\end{prooftree}
	Applying $L\vee$ on the sequents that we get from induction
	\begin{prooftree}
    \noLine
		\AXC{$\mathcal{D}_0'$}
		\UIC{$\Gamma, \nabla^r B \Rightarrow \nabla^m A$}
		
		\noLine
		\AXC{$\mathcal{D}_1$}
		\UIC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow \Delta$}
		
		\RightLabel{IH}
		\BIC{$\{\nabla^{n_i} \Gamma, \nabla^{n_i+r} B\}, \nabla^m \Sigma \Rightarrow \nabla^m \Delta$}
		

    \noLine
		\AXC{$\mathcal{D}_0''$}
		\UIC{$\Gamma, \nabla^r C \Rightarrow \nabla^m A$}
		
		\noLine
		\AXC{$\mathcal{D}_1$}
		\UIC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow \Delta$}
		
		\RightLabel{IH}
    \BIC{$\{\nabla^{n_i} \Gamma, \nabla^{n_i+r} C\}, \nabla^m \Sigma \Rightarrow \nabla^m \Delta$}

		\RightLabel{$L\vee$}
		\BIC{$\{\nabla^{n_i} \Gamma, \nabla^{n_i+r} (B \vee C)\}, \nabla^m \Sigma \Rightarrow \nabla^m \Delta$}
	 \end{prooftree}

 
\noindent $L\rightsquigarrow$: Suppose $\mathcal{D}_0$ ends with a $L\rightsquigarrow$ as shown below.
 \begin{prooftree}
  \noLine
  \AXC{$\mathcal{D}_0'$}
  \UIC{$\Gamma \Rightarrow \nabla^r B$}
  \noLine
  \AXC{$\mathcal{D}_0''$}
  \UIC{$\Gamma , \nabla^r C \Rightarrow \nabla^m A$}
  \RightLabel{$L\rightsquigarrow$}
  \BIC{$\Gamma , \nabla^{r+1} (B \rightsquigarrow C) \Rightarrow \nabla^m A$}
 \end{prooftree}
 From induction hypothesis we have
 \begin{prooftree}
  \noLine
  \AXC{$\mathcal{D}_0''$}
  \UIC{$\Gamma , \nabla^r C \Rightarrow \nabla^m A$}
  \noLine
  \AXC{$\mathcal{D}_1$}
  \UIC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow \Delta$}
  \RightLabel{IH} \LeftLabel{$\mathcal{D}':~~~~$}
  \BIC{$\{\nabla^{n_i} \Gamma , \nabla^{n_i+r} C\} , \nabla^m \Sigma \Rightarrow \nabla^m \Delta$}
 \end{prooftree}
 In order to apply $L\rightsquigarrow$, we must prepare the context in $\mathcal{D}_0'$, for each of $\nabla^{n_i+r}C$'s. Beginning with $n_0$, first we need to apply $N$ on $\mathcal{D}_0'$ $n_0$ times to get $\nabla^{n_0}\Gamma$ on the left and $\nabla^{n_0+r} B$ on the right side. Then we can just add the rest of the context by $Lw$.
 \begin{prooftree}
  \noLine
  \AXC{$\mathcal{D}_0'$}
  \UIC{$\Gamma \Rightarrow \nabla^r B$}
  \doubleLine \RightLabel{$N$}
  \UIC{$\nabla^{n_0} \Gamma \Rightarrow \nabla^{n_0+r} B$}
  \doubleLine \RightLabel{$Lw$} \LeftLabel{$\mathcal{D}'_{n_0}:~~~~$}
  \UIC{$\nabla^{n_0}\Gamma, \{\nabla^{n_i} \Gamma, \nabla^{n_i+r}C\}_{i>0} , \nabla^m \Sigma \Rightarrow \nabla^{n_0+r} B$}
 \end{prooftree}
 By $L\rightsquigarrow$ on $\mathcal{D}'$ and $\mathcal{D}'_{n_0}$, we have
 \[\nabla^{n_0}\Gamma, \{\nabla^{n_i} \Gamma, \nabla^{n_i+r}C\}_{i>0}, \nabla^{n_0+r+1} (B \rightsquigarrow C) , \nabla^m \Sigma \Rightarrow \nabla^m \Delta\]
 We can repeat for this all of $n_i$'s to get
 \[\{\nabla^{n_i} \Gamma, \nabla^{n_i+r+1}(B \rightsquigarrow C)\}, \nabla^m \Sigma \Rightarrow \nabla^m \Delta\]
 which is the desired sequent.


 $\nabla Cut$: Assume $\mathcal{D}_0$ ends with a $\nabla Cut$ with cut-data $(A', m', \{n_i'\})$. Notice that by assumption, $A'$ must have a lower rank than $A$.
 \begin{prooftree}
   \noLine
   \AXC{$\mathcal{D}_0'$}
   \UIC{$\Gamma \Rightarrow \nabla^{m'} A'$}
   
   \noLine
   \AXC{$\mathcal{D}_0''$}
   \UIC{$\Pi , \{\nabla^{n_i'} A'\} \Rightarrow \nabla^m A$}
   
   \RightLabel{$\nabla Cut$}
   \BIC{$\{\nabla^{n_i'} \Gamma\} , \nabla^{m'} \Pi \Rightarrow \nabla^{m+m'} A$}
 \end{prooftree}
 We must construct a proof-tree for $\{\nabla^{n_i}\{\nabla^{n_i'} \Gamma\}, \nabla^{n_i+m'} \Pi\} , \nabla^{m+m'}\Sigma \Rightarrow \nabla^{m+m'}\Delta$. We can use the induction hypothesis to remove $A$ first, then cut $A'$.
 \begin{prooftree}
   \noLine
   \AXC{$\mathcal{D}_0'$}
   \UIC{$\Gamma \Rightarrow \nabla^{m'} A'$}
   
   \noLine
   \AXC{$\mathcal{D}_0''$}
   \UIC{$\Pi , \{\nabla^{n_i'} A'\} \Rightarrow \nabla^m A$}

   \noLine
   \AXC{$\mathcal{D}_1$}
   \UIC{$\Sigma , \{\nabla^{n_i} A\} \Rightarrow \Delta$}

   \RightLabel{IH}
   \BIC{$\{\nabla^{n_i} \Pi , \nabla^{n_i}\{\nabla^{n_i'} A'\}\} , \nabla^m \Sigma \Rightarrow \nabla^m \Delta$}
   

   \RightLabel{$MC$}
   \BIC{$\{\nabla^{n_i}\{\nabla^{n_i'} \Gamma\}, \nabla^{n_i+m'} \Pi\} , \nabla^{m+m'}\Sigma \Rightarrow \nabla^{m+m'}\Delta$}
 \end{prooftree}

 $Rw$: In this case, $\mathcal{D}_0'$ proves $\Gamma \Rightarrow$, so we can simply construct the desired proof-tree using $N$, $Lw$ and $Rw$.
 \begin{prooftree}
   \noLine
   \AXC{$\mathcal{D}_0'$}
   \UIC{$\Gamma \Rightarrow$}
   \doubleLine \RightLabel{$N$}
   \UIC{$\nabla^{n_0} \Gamma \Rightarrow$}
   \doubleLine \RightLabel{$Lw$}
   \UIC{$\{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma \Rightarrow$}
   \RightLabel{$Rw$}
   \UIC{$\{\nabla^{n_i} \Gamma\} , \nabla^m \Sigma \Rightarrow \nabla^m \Delta$}
 \end{prooftree}

 $N$: $\mathcal{D}_0$ proves $\nabla \Gamma \Rightarrow \nabla^{m+1} A$ and the cut-formula is in the form $\nabla A$. So we want to construct $\{\nabla^{n_i+1}\Gamma\}, \nabla^m \Sigma \Rightarrow \nabla^m \Delta$. Induction hypothesis for $\mathcal{D}_0$'s immediate sub-tree and $\mathcal{D}_1$ gives us exactly what we want.

 $Fu'$: It suffices to apply $Fu'$ on the result of the induction.\\

 The rest of the cases for $\mathcal{D}_0$ can't be solved independent of $\mathcal{D}_1$, so we will consider cases for the last rule of $\mathcal{D}_1$, again, where they're handled independent of $\mathcal{D}_0$. But this time we have much less possibilities for the opposite sub-tree, since we've already solved many of them. In fact the only possible rules for the last rule of $\mathcal{D}_0$ are now $R\star (\star \in \{\land, \lor_{1/2}, \rightarrow, \rightsquigarrow\})$ and $Fa$.

 This time, suppose $\mathcal{D}_1$ is and axiom. Again, the $Id$ case is trivial, $Ta$ won't happen, and $Ex$ is also infeasible, since all possible rules for $\mathcal{D}_0$ alter the right side of the sequent, but none of them is able to introduce $\bot$ there.

 Next, for cases that the cut-burden is not altered (modulo $\nabla$) in the last rule of $\mathcal{D}_1$, the construction is similar to the previous cases: Applying the same rule on the sequent that we get from the induction hypothesis. For the sake of briefness, we will mention only cases for $L\wedge_1$, $R\vee_1$, $R\rightsquigarrow$ and $N$.

 $L\wedge$: Assume that $\mathcal{D}_1$ ends with $L\wedge_1$, but no member of the cut-burden is it's principal formula.
 \begin{prooftree}
	\AXC{$\mathcal{D}_1'$} \noLine
	\UIC{$\Sigma, \{\nabla^{n_i} A\}, \nabla^r B \Rightarrow \Delta$}
	\RightLabel{$L\wedge_1$}
	\UIC{$\Sigma, \{\nabla^{n_i} A\}, \nabla^r (B \wedge C) \Rightarrow \Delta$}
 \end{prooftree}
 From induction hypothesis we have $\{\nabla^{n_i} \Gamma\}, \nabla^m \Sigma, \nabla^{r+m} B \Rightarrow \nabla^m \Delta$. By $L\wedge_1$ we have $\{\nabla^{n_i} \Gamma\}, \nabla^m \Sigma, \nabla^{r+m} (B \wedge C) \Rightarrow \nabla^m \Delta$.

 $R\vee_1$: Suppose that $\mathcal{D}_1$ ends with $L\vee_1$ and its principal formula is not in the cut-burden.
 \begin{prooftree}
	\AXC{$\mathcal{D}_1'$} \noLine
	\UIC{$\Sigma, \{\nabla^{n_i} A\} \Rightarrow \nabla^r B$}
	\RightLabel{$L\vee_1$}
	\UIC{$\Sigma, \{\nabla^{n_i} A\} \Rightarrow \nabla^r (B \vee C)$}
 \end{prooftree}
 Again, use the induction hypothesis to get $\{\nabla^{n_i} \Gamma\}, \nabla^m\Sigma \Rightarrow \nabla^{r+m} B$, then apply $L\vee_1$ to reach the desired sequent.

$R\rightsquigarrow$: In the case where $\mathcal{D}_1$ ends with an $R\rightsquigarrow$, the cut-burden is altered in the premise. So the induction hypothesis has a different cut-data. nevertheless, it still commutes with $R\rightsquigarrow$.
\begin{prooftree}
	\AXC{$\mathcal{D}_1'$} \noLine
	\UIC{$\nabla\Sigma, \{\nabla^{n_i+1} A\}, B \Rightarrow C$}
	\RightLabel{$L\rightsquigarrow$}
	\UIC{$\Sigma, \{\nabla^{n_i} A\} \Rightarrow B \rightsquigarrow C$}
 \end{prooftree}
From induction hypothesis, we have $\{\nabla^{n_i+1} \Gamma\}, \nabla^{m+1} \Sigma, \nabla^m B \Rightarrow \nabla^m C$. We can simply apply $R\rightsquigarrow$ to get $\{\nabla^{n_i} \Gamma\}, \nabla^m \Sigma \Rightarrow \nabla^m (B \rightsquigarrow C)$.

$N$: Suppose $\mathcal{D}_1$ ends with $N$.
\begin{prooftree}
	\AXC{$\mathcal{D}_1'$} \noLine
	\UIC{$\Sigma, \{\nabla^{n_i} A\} \Rightarrow \Delta$}
	\RightLabel{$N$}
	\UIC{$\nabla \Sigma, \{\nabla^{n_i+1} A\} \Rightarrow \nabla \Delta$}
\end{prooftree}
If we assume that the cut-data is $(A, m, \{n_i+1\})$, from the induction hypothesis we have $\{\nabla^{n_i} \Gamma\}, \nabla^m \Sigma \Rightarrow \nabla^m \Delta$. By $N$ we have $\{\nabla^{n_i+1} \Gamma\}, \nabla^{m+1} \Sigma \Rightarrow \nabla^{m+1} \Delta$, which is the desired sequent.
But if $m>0$, the cut-data could also be $(\nabla A, m-1, \{n_i\})$, in which case using the induction hypothesis would suffice.

 Now for the rest of the proof, we will show how the construction takes place in the cases where the cut-formula is principal in the last rule of $\mathcal{D}_1$, which can be either of $L\star (\star \in \{\land, \lor_{1/2}, \rightarrow, \rightsquigarrow\})$.
 Any of these rules imply a specific form for the cut-formula, which can also determine the rule at the end of the other proof-tree, because the cut-formula is also principal in the last rule of $\mathcal{D}_0$ (note that the only possible rules for the last rule of $\mathcal{D}_0$ are now $R\star (\star \in \{\land, \lor_{1/2}, \rightarrow, \rightsquigarrow\})$ and $Fa$.
 
 First, notice that $m > 1$ is impossible, since the only rule that introduces $\nabla$ to the right of the sequence is $Fa$, which introduces a $\rightsquigarrow$ immediately after the $\nabla$ and implies $m = 1$. So suppose $m = 1$ and $\mathcal{D}_0$ end with $Fa$.
 \begin{prooftree}
	 \AXC{$\mathcal{D}_0'$}
	 \noLine
	 \UIC{$\Gamma, A \Rightarrow B$}
	 \RightLabel{$Fa$}
	 \UIC{$\Gamma \Rightarrow \nabla (A \rightsquigarrow B)$}
 \end{prooftree}
 The cut-data must be of the form $(A \rightsquigarrow B, 1, \{n_i\})$, so the only option for $\mathcal{D}_1$ is $L\rightsquigarrow$.
 \begin{prooftree}
	 \AXC{$\mathcal{D}_1'$}
	 \noLine
	 \UIC{$\Sigma, \{\nabla^{n_i} (A \rightsquigarrow B) \}_{i>0}, \Rightarrow \nabla^{n_0} A$}
	 \AXC{$\mathcal{D}_1''$}
	 \noLine
	 \UIC{$\Sigma, \{\nabla^{n_i} (A \rightsquigarrow B) \}_{i>0}, \nabla^{n_0} B \Rightarrow \Delta$}
	 \RightLabel{$L\rightsquigarrow$}
	 \BIC{$\Sigma, \{\nabla^{n_i} (A \rightsquigarrow B)\}_{i>0}, \nabla^{n_0+1} (A \rightsquigarrow B) \Rightarrow \Delta$}
 \end{prooftree}
 We want to prove $\{\nabla^{n_i} \Gamma\}_{i>0}, \nabla^{n_0+1} \Gamma, \nabla \Sigma \Rightarrow \nabla \Delta$. To do so, we first apply a low rank $\nabla Cut$ (with $(B, 0, (n_0+1))$ as the cut-data) on $\mathcal{D}_0'$ and $IH(\mathcal{D}_0, \mathcal{D}_1'')$.
 \begin{prooftree}
	 \AXC{$\mathcal{D}_0'$}
	 \noLine
	 \UIC{$\Gamma, A \Rightarrow B$}
	 \AXC{$\mathcal{D}_0$}
	 \noLine
	 \UIC{$\Gamma \Rightarrow \nabla (A \rightsquigarrow B)$}
	 \AXC{$\mathcal{D}_1''$}
	 \noLine
	 \UIC{$\Sigma, \{\nabla^{n_i} (A \rightsquigarrow B) \}_{i>0}, \nabla^{n_0} B \Rightarrow \Delta$}
	 \BIC{$\{\nabla^{n_i} \Gamma\}_{i>0}, \nabla \Sigma, \nabla^{n_0+1} B \Rightarrow \nabla \Delta$}
	 \RightLabel{$\nabla Cut$} \LeftLabel{$\mathcal{D}':~~~~~$}
	 \BIC{$\nabla^{n_0+1} \Gamma, \nabla^{n_0+1} A, \{\nabla^{n_i} \Gamma\}_{i>0}, \nabla \Sigma \Rightarrow \nabla \Delta$}
 \end{prooftree}
 Then cut $IH(\mathcal{D}_0, \mathcal{D}_1')$ (this time with $\nabla^{n_0+1} A$ as the cut-formula) into the resulting sequent.
 \begin{prooftree}
	 \AXC{$\mathcal{D}_1'$}
	 \noLine
	 \UIC{$\Sigma, \{\nabla^{n_i} (A \rightsquigarrow B) \}_{i>0}, \Rightarrow \nabla^{n_0} A$}
	 \AXC{$\mathcal{D}_0$}
	 \noLine
	 \UIC{$\Gamma \Rightarrow \nabla (A \rightsquigarrow B)$}
	 \RightLabel{IH}
	 \BIC{$\{\nabla^{n_i} \Gamma\}_{i>0}, \nabla \Sigma, \Rightarrow \nabla^{n_0 + 1} A$}

	 \AXC{$\mathcal{D}'$}

	 \RightLabel{$\nabla Cut$}
	 \BIC{$(\{\nabla^{n_i} \Gamma\}_{i>0})^2, \nabla^{n_0+1} \Gamma, (\nabla \Sigma)^2 \Rightarrow \nabla \Delta$}
	 \doubleLine \RightLabel{$Lc$}
	 \UIC{$\{\nabla^{n_i} \Gamma\}_{i>0}, \nabla^{n_0+1} \Gamma, \nabla \Sigma \Rightarrow \nabla \Delta$}
 \end{prooftree}

 \noindent When $m = 0$, each right-rule for $\mathcal{D}_1$ determines its corresponding left-rule for $\mathcal{D}_0$.

 $R\land$ and $L\land$: Suppose $\mathcal{D}_0$ ends with $R\land$ and $\mathcal{D}_1$ with either of $L\land_c ~ (c \in \{1,2\})$.
 \begin{prooftree}
	 \noLine
	 \AXC{$\mathcal{D}_0'$}
	 \UIC{$\Gamma \Rightarrow A_1$}
	 \noLine
	 \AXC{$\mathcal{D}_0''$}
	 \UIC{$\Gamma \Rightarrow A_2$}
	 \RightLabel{$R\land$}
	 \BIC{$\Gamma \Rightarrow A_1 \land A_2$}
	 
	 \noLine
	 \AXC{$\mathcal{D}_1'$}
	 \UIC{$\Sigma , \{\nabla^{n_i} (A_1 \land A_2)\}_{i>0}, \nabla^{n_0} A_c \Rightarrow \Delta$}
	 \RightLabel{$L\land_1$}
	 \UIC{$\Sigma , \{\nabla^{n_i} (A_1 \land A_2)\} \Rightarrow \Delta$}
	 
	 \noLine
	 \BIC{}
 \end{prooftree}
 $IH(\mathcal{D}_0, \mathcal{D}_1')$ proves $\{\nabla^{n_i} \Gamma\}_{i>0} , \Sigma , \nabla^{n_0} A_c \Rightarrow \Delta$. Remove $\nabla^{n_0} A_c$ with a low rank $\nabla Cut$ on this sequent and either of $\mathcal{D}_0'$ ($c = 1$) or $\mathcal{D}_0''$ ($c = 2$) to get $\{\nabla^{n_i} \Gamma\}, \Sigma \Rightarrow \Delta$.

 $R\lor$ and $L\lor$: Suppose $\mathcal{D}_0$ ends with either of $R\lor_c ~ (c \in \{1,2\})$ and $\mathcal{D}_1$ with $L\lor$.
 \begin{prooftree}
	 \noLine
	 \AXC{$\mathcal{D}_0'$}
	 \UIC{$\Gamma \Rightarrow A_c$}
	 \RightLabel{$R\lor_c$}
	 \UIC{$\Gamma \Rightarrow A_1 \lor A_2$}
 \end{prooftree}
 \begin{prooftree}
	\noLine
	\AXC{$\mathcal{D}_1'$}
	\UIC{$\Sigma , \{\nabla^{n_i} (A_1 \lor A_2)\}_{i>0} , \nabla^{n_0} A_1 \Rightarrow \Delta$}
	\noLine
	\AXC{$\mathcal{D}_1''$}
	\UIC{$\Sigma , \{\nabla^{n_i} (A_1 \lor A_2)\}_{i>0} , \nabla^{n_0} A_2 \Rightarrow \Delta$}
	\RightLabel{$L\lor$}
	\BIC{$\Sigma ,  \{\nabla^{n_i} (A_1 \lor A_2)\} \Rightarrow \Delta$}
 \end{prooftree}
 Using induction hypothesis, first remove $\{\nabla^{n_i} (A_1 \lor A_2)\}_{i>0}$ from the sub-tree of $\mathcal{D}_1$ that has $\nabla^{n_0} A_c$ ($IH(\mathcal{D}_0, \mathcal{D}_1')$ for $c = 1$, $IH(\mathcal{D}_0, \mathcal{D}_1'')$ for $c = 2$), to get $\{\nabla^{n_i} \Gamma\}_{i>0}, \Sigma , \nabla^{n_0} A_c \Rightarrow \Delta$. Then remove $\nabla^{n_0} A_c$ by a low rank $\nabla Cut$ on this sequent and $\mathbf{D_0}'$ to get $\{\nabla^{n_i} \Gamma\}, \Sigma \Rightarrow \Delta$.

 $R\rightarrow$ and $L\rightarrow$: Suppose $\mathcal{D}_0$ and $\mathcal{D}_1$ end with $R\rightarrow$ and $L\rightarrow$ respectively.
 \begin{prooftree}
	 \noLine
	 \AXC{$\mathcal{ D}_0'$}
	 \UIC{$\Gamma, A_1 \Rightarrow A_2$}
	 \RightLabel{$R\rightarrow$}
	 \UIC{$\Gamma \Rightarrow A_1 \rightarrow A_2$}        
	 \end{prooftree}
	 \begin{prooftree}
	 \noLine
	 \AXC{$\mathcal{D}_1'$}
	 \UIC{$\Sigma, \{\nabla^{n_i} (A_1 \rightarrow A_2)\}_{i>0} \Rightarrow \nabla^{n_0} A_1$}
	 \noLine
	 \AXC{$\mathcal{D}_1''$}
	 \UIC{$\Sigma, \{\nabla^{n_i} (A_1 \rightarrow A_2)\}_{i>0}, \nabla^{n_0} A_2 \Rightarrow \Delta$}
	 \RightLabel{$L\rightarrow$}
	 \BIC{$\Sigma,  \{\nabla^{n_i} (A_1 \rightarrow A_2)\} \Rightarrow \Delta$}
 \end{prooftree}
 
 $IH(\mathcal{D}_0, \mathcal{D}_1'')$ proves $\{\nabla^{n_i} \Gamma\}_{i>0}, \Sigma, \nabla^{n_0} A_2 \Rightarrow \Delta$. Applying a low rank $\nabla Cut$ on $\mathcal{D}_0'$ and this sequent removes $\nabla^{n_0} A_2$ and introduces $\nabla^{n_0} \Gamma$ and $\nabla^{n_0} A_1$ to the left. On the other hand $IH(\mathcal{D}_0, \mathcal{D}_1')$ proves $\{\nabla^{n_i} \Gamma\}_{i>0}, \Sigma, \Rightarrow \nabla^{n_0} A_1$, which we can use to also remove $\nabla^{n_0} A_1$ with another low rank cut, and then remove the extra $\nabla^{n_0} \Gamma$ and $\Sigma$ with $Lc$.

 $R\rightsquigarrow$ and $L\rightsquigarrow$: Is just like the $\rightarrow$ case. Notice that the extra $\nabla$ on the left side of the subtree of $\mathcal{D}_0$ will provide the extra $\nabla$ on the principal formula in $\mathcal{D}_1$.

 $Fa$ and $L\rightsquigarrow$: This is also similar to the $m = 1$ case, except that here the cut-data is $(\nabla (A \rightsquigarrow B), 0, \{n_i\})$.
 \vspace{5mm}

 This concludes the proof the theorem in all cases. Notice that we have a construction for any two possible pair of rules, in both systems and all their variations.

\end{proof}

\begin{thm}\label{thm:ldls-cut-elim}[Cut Elimination]
	For any $\Gamma$ and $\Delta$, If $\Gamma \Rightarrow \Delta$ is provable by $\mathbf{LDL}^*_\rightsquigarrow(\star)$, then it is so by $\mathbf{LDL}^*_\rightsquigarrow(\star)-\{Cut\}$.
\end{thm}
\begin{proof}
		First, we will show that for any non-zero-rank proof of $\Gamma \Rightarrow \Delta$ like $\mathcal{D}$ in $\mathbf{LDL}^*_\rightsquigarrow(\star)$, there is another proof of the same sequent with a lower rank. Suppose $\mathcal{D}$ has sub-tree(s) called $\mathcal{D}_0$ (and possibly $\mathcal{D}_1$). Using induction on $h(\mathcal{D})$, the induction hypothesis for $\mathcal{D}_i ~(i \in \{0,1\})$ gives us a proof-tree with the same conclusion, which we call $IH(\mathcal{D}_i)$, but with a lower rank, i.e. $\rho(IH(\mathcal{D}_i)) < \rho(\mathcal{D}_i)$. We now consider two cases for the last rule of $\mathcal{D}$

	\begin{enumerate}[label=\Roman*]
		\item If the last rule of $\mathcal{D}$ is of a lower rank than $\rho(\mathcal{D})$, i.e. the $Cut$ instance with the maximum rank is not the last rule in $\mathcal{D}$, then we can apply the same last rule on $IH(\mathcal{D}_i)$'s and get a proof of $\Gamma \Rightarrow \Delta$ with a lower rank.
		
		\item If the last rule of $\mathcal{D}$ is an instance of $Cut$ rule with a cut-formula of rank $\rho(\mathcal{D})$, then we can apply theorem \ref{thm:ldls-cut-reduction} to $IH(\mathcal{D}_0)$ and $IH(\mathcal{D}_1)$ to get the same $Cut$ with a lower rank. (Recall that $\nabla Cut$ is just a generalization of $Cut$, so the theorem applies.)
	\end{enumerate}
	So for any proof of $\Gamma \Rightarrow \Delta$ in $\mathbf{LDL}^*_\rightsquigarrow(\star)$, we also have a proof with rank $0$, which is cut-free.
\end{proof}

\subsection{Admissible Rules}
\textbf{Problem.} What are the Harrop formulas here? Prove the disjunction property for the theories axiomatized by Harrop formulas, using the cut-free proofs over the logics $\mathbf{LDL}$ and $\mathbf{LDL}_{\rightsquigarrow}$. Prove the same thing via Kleene-type argument. Do we have similar thing for the logics with added rules $H$ and $H_{\rightsquigarrow}$, respectively?

\subsection{Interpolation}
In this section, we prove \emph{Craig's interpolation} theorem for $\mathbf{LDL}(\star)$ and a weaker version called \emph{deductive interpolation} for $\mathbf{LDL}_\rightsquigarrow(\star)$. For a formula $A$, by $P(A)$ we mean the set of all atomic formulas of $A$ and for a multi-set of formulas $\Gamma$, $P(\Gamma) = \bigcup_{A \in \Gamma} P(A)$.
\begin{thm}[Craig's Interpolation for $\mathbf{LDL}(\star)$]\label{thm:ldl-craig} For any $\Gamma_1$, $\Gamma_2$ and $\Delta$, if $\mathbf{LDL}(\star) \vdash \Gamma_1 , \Gamma_2 \Rightarrow \Delta$, then there is a formula $C$ such that $P(C) \subseteq P(\Gamma_1) \cap P(\Gamma_2 , \Delta)$, $\mathbf{LDL}(\star) \vdash \Gamma_1 \Rightarrow C$ and $\mathbf{LDL}(\star) \vdash \Gamma_2 , C \Rightarrow \Delta$.
\end{thm}

\begin{proof}
Let $\mathcal{D}$ be the $\mathbf{LDL}(\star)$ proof of $\Gamma_1 , \Gamma_2 \Rightarrow \Delta$. We will use induction on the length of $\mathcal{D}$, so for any $\Gamma_1'$, $\Gamma_2'$ and $\Delta'$ such that $\mathbf{LDL}(\star) \vdash \Gamma_1' , \Gamma_2' \Rightarrow \Delta'$ with a proof smaller than $\mathcal{D}$, the induction hypothesis (IH) gives an interpolant $C_{\langle\Gamma_1'; \Gamma_2'; \Delta'\rangle}$ for which the statement of the theorem is true. We now build the desired interpolant $C$, in different cases for the last rule of $\mathcal{D}$. In cases for left-rules, we also need to consider whether the principal formula is in $\Gamma_1$ or $\Gamma_2$ in separate cases.
\begin{enumerate}
	\item ($Id$) We have $\Gamma_1,\Gamma_2 = \Delta = A$.
	\begin{enumerate}
		\item If $\Gamma_1 = \{\}$ and $\Gamma_2 = A$, then define $C = \top$. So we have $\Rightarrow \top$ by $Ta$ and $A , \top \Rightarrow A$ by $Id$ and $Lw$.
		
		\item If $\Gamma_1 = A$ and $\Gamma_2 = \{\}$ then define $C = A$. So we have $A \Rightarrow A$ by $Id$.
	\end{enumerate}
	\item ($Ta$) Take $C = \top$.
	
	\item ($Ex$) Take $C = \nabla^n \bot$.
	
	\item ($Lw$) $\mathcal{D}$ proves $\Gamma_1' , \Gamma_2' , A \Rightarrow \Delta$ and has a sub-proof for $\Gamma_1' , \Gamma_2' \Rightarrow \Delta$, for which IH gives an interpolant $C_{\langle\Gamma_1';\Gamma_2';\Delta\rangle}$ and proofs for $\Gamma_1' \Rightarrow C_{\langle\Gamma_1';\Gamma_2';\Delta\rangle}$ and $\Gamma_2 , C_{\langle\Gamma_1';\Gamma_2';\Delta\rangle} \Rightarrow \Delta$, such that $P(C_{\langle\Gamma_1';\Gamma_2';\Delta\rangle}) \subseteq$ $ P(\Gamma_1') \cap P(\Gamma_2' , \Delta)$.
	\begin{enumerate}
		\item If $\Gamma_1 = \Gamma_1'$ and $\Gamma_2 = \Gamma_2' , A$, take $C = C_{\langle\Gamma_1';\Gamma_2';\Delta\rangle}$. Then we have  $\Gamma_1' \Rightarrow C$ by IH and $\Gamma_2 , A , C \Rightarrow \Delta$ by $Lw$ and IH. From IH, we also have $P(C) \subseteq P(\Gamma_1') \cap P(\Gamma_2' , A , \Delta)$, since $P$ takes ``$,$'' to ``$\cup$'', which distributes over ``$\cap$'' and is increasing with respect to ``$\subseteq$''.
		
		\item If $\Gamma_1 = \Gamma_1' , A$ and $\Gamma_2 = \Gamma_2'$, again take $C = C_{\langle\Gamma_1';\Gamma_2';\Delta\rangle}$. Then we have  $\Gamma_1' , A \Rightarrow C$ by $Lw$ and IH, and $\Gamma_2 , C \Rightarrow \Delta$ by IH. We also have $P(C) \subseteq P(\Gamma_1' , A) \cap P(\Gamma_2' , \Delta)$ by IH and argument similar to the previous case.
	\end{enumerate}

	\item ($Lc$) $\mathcal{D}$ proves $\Gamma_1' , \Gamma_2' , A \Rightarrow \Delta$ and has a sub-proof for $\Gamma_1' , \Gamma_2' , A , A \Rightarrow \Delta$.
	\begin{enumerate}
		\item If $\Gamma_1 = \Gamma_1'$ and $\Gamma_2 = \Gamma_2' , A$, take $C = C_{\langle\Gamma_1';\Gamma_2',A,A;\Delta\rangle}$. Then we have $\Gamma_1' \Rightarrow C$ by IH and $\Gamma_2' , A \Rightarrow \Delta$ by IH and $Lc$. From IH, we also have $P(C) \subseteq P(\Gamma_1') \cap P(\Gamma_2',A,\Delta)$, since $P(\Gamma,X) = P(\Gamma,X,X)$.
		
		\item If $\Gamma_1 = \Gamma_1' , A$ and $\Gamma_2 = \Gamma_2'$, take $C = C_{\langle\Gamma_1',A,A;\Gamma_2';\Delta\rangle}$. Then we have $\Gamma_1' , A \Rightarrow C$ by IH and $Lc$, and $\Gamma_2' \Rightarrow \Delta$ by IH. We also have $P(C) \subseteq P(\Gamma_1',A) \cap P(\Gamma_2',\Delta)$ as justified before.
	\end{enumerate}

	\item[6,7.] ($L\land_i$, {\small$i \in \{1,2\}$}) $\mathcal{D}$ proves $\Gamma_1' , \Gamma_2' , \nabla^n (A_1 \land A_2) \Rightarrow \Delta$ and has a sub-proof for $\Gamma_1' , \Gamma_2' , \nabla^n A_i \Rightarrow \Delta$.
	\begin{enumerate}
		\item If $\Gamma_1 = \Gamma_1'$ and $\Gamma_2 = \Gamma_2' , \nabla^n (A_1 \land A_2)$, take $C = C_{\langle\Gamma_1';\Gamma_2',\nabla^n A_i;\Delta\rangle}$. Then we have $\Gamma_1' \Rightarrow C$ by IH and $\Gamma_2' , \nabla^n (A_1 \land A_2) \Rightarrow \Delta$ by IH and $L\land_i$. From IH, we also have $P(C) \subseteq$ $P(\Gamma_1') \cap P(\Gamma_2',\nabla^n(A_1 \land A_2),\Delta)$, since $P(\nabla^n X) = P(X)$ and $P$ takes sub-formula ordering to ``$\subseteq$''.
		
		\item If $\Gamma_1 = \Gamma_1' , \nabla^n (A_1 \land A_2)$ and $\Gamma_2 = \Gamma_2'$, take $C = C_{\langle\Gamma_1',\nabla^n A_i;\Gamma_2';\Delta\rangle}$. Then we have $\Gamma_1' , \nabla^n (A_1 \land A_2)$ $\Rightarrow C$ by IH and $L\land_i$. Also from IH we have $\Gamma_2' \Rightarrow \Delta$. We also have $P(C) \subseteq P(\Gamma_1',\nabla^n (A_1 \land A_2))$ $\cap P(\Gamma_2',\Delta)$ as justified in the previous case.
	\end{enumerate}
	\setcounter{enumi}{7}

	\item ($R\land$) $\mathcal{D}$ proves $\Gamma_1 , \Gamma_2 \Rightarrow A \land B$ and has sub-proofs for $\Gamma_1 , \Gamma_2 \Rightarrow A$ and $\Gamma_1 , \Gamma_2 \Rightarrow B$.\\
	Let $C_1 = C_{\langle\Gamma_1;\Gamma_2;A\rangle}$ and $C_2 = C_{\langle\Gamma_1;\Gamma_2;B\rangle}$, and then take $C = C_1 \land C_2$.
	We have $\Gamma_1 \Rightarrow C_1$ and $\Gamma_1 \Rightarrow C_2$, both from IH. Then by $R\land$ we have $\Gamma_1 \Rightarrow C_1 \land C_2$.
	We also have $\Gamma_2 , C_1 \Rightarrow A$ and $\Gamma_2 , C_2 \Rightarrow B$, again from IH.
	We can then derive $\Gamma_2 , C_1 \land C_2 \Rightarrow A$ and $\Gamma_2 , C_1 \land C_2 \Rightarrow B$, respectively by $L\land_1$ and $L\land_2$, and finally  $\Gamma_2 , C_1 \land C_2 \Rightarrow A \land B$ by $R\land$.
	We also have $P(C_1) \subseteq P(\Gamma_1) \cap P(\Gamma_2 , A)$ and $P(C_2) \subseteq P(\Gamma_1) \cap P(\Gamma_2 , B)$. So $P(C_1 , C_2) \subseteq P(\Gamma_1) \cap P(\Gamma_2 , A , B)$ as it was justified before, and then $P(C_1 \land C_2) \subseteq P(\Gamma_1) \cap P(\Gamma_2 , A \land B)$.
	
	\item ($L\lor$) $\mathcal{D}$ proves $\Gamma_1' , \Gamma_2' , \nabla^n (A \lor B) \Rightarrow \Delta$ and has sub-proofs for $\Gamma_1' , \Gamma_2' , \nabla^n A \Rightarrow \Delta$ and $\Gamma_1' , \Gamma_2' , \nabla^n B \Rightarrow \Delta$.
	\begin{enumerate}
		\item If $\Gamma_1 = \Gamma_1'$ and $\Gamma_2 = \Gamma_2' , \nabla^n (A \lor B)$, let $C_1 = C_{\langle\Gamma_1';\Gamma_2',\nabla^n A;\Delta\rangle}$ and $C_2 = C_{\langle\Gamma_1';\Gamma_2',\nabla^n B;\Delta\rangle}$, and then take $C = C_1 \land C_2$.
		We have $\Gamma_1' \Rightarrow C_1 \land C_2$ from IH and $R\land$.
		From IH, by $L\land_1$ and $L\land_2$ we can derive $\Gamma_2' , \nabla^n A , C_1 \land C_2 \Rightarrow \Delta$ and $\Gamma_2' , \nabla^n B , C_1 \land C_2 \Rightarrow \Delta$ respectively, to which we apply $L\lor$ to get to $\Gamma_2' , \nabla^n (A \lor B) , C_1 \land C_2 \Rightarrow \Delta$.
		From IH, we also have $P(C_1) \subseteq P(\Gamma_1') \cap P(\Gamma_2' , \nabla^n A , \Delta)$ and $P(C_2) \subseteq P(\Gamma_1') \cap P(\Gamma_2' , \nabla^n B , \Delta)$. Just like the previous case, we can deduce that $P(C_1 \land C_2) \subseteq P(\Gamma_1') \cap P(\Gamma_2' , \nabla^n (A \land B) , \Delta)$.

		\item If $\Gamma_1 = \Gamma_1' , \nabla^n (A \lor B)$ and $\Gamma_2 = \Gamma_2'$, let $C_1 = C_{\langle\Gamma_1',\nabla^n A;\Gamma_2';\Delta\rangle}$ and $C_2 = C_{\langle\Gamma_1',\nabla^n B;\Gamma_2';\Delta\rangle}$, and then take $C = C_1 \lor C_2$.
		From IH, by $R\lor_1$ and $R\lor_2$ we can derive $\Gamma_1' , \nabla^n A \Rightarrow C_1 \lor C_2$ and $\Gamma_1' , \nabla^n B \Rightarrow C_1 \lor C_2$ respectively, to which we apply $L\lor$ to get to $\Gamma_1' , \nabla^n (A \lor B) \Rightarrow C_1 \lor C_2$.
		We have $\Gamma_2' , C_1 \lor C_2 \Rightarrow \Delta$ from IH and $L\lor$.
		From IH, we also have $P(C_1) \subseteq P(\Gamma_1' , \nabla^n A) \cap$ $P(\Gamma_2' , \Delta)$ and $P(C_2) \subseteq P(\Gamma_1' , \nabla^n B) \cap P(\Gamma_2' , \Delta)$. Just like the previous case, we can deduce that $P(C_1 \lor C_2) \subseteq P(\Gamma_1' , \nabla^n (A \land B)) \cap P(\Gamma_2' , \Delta)$.
	\end{enumerate}

	\item[10,11.] ($R\lor_i$, {\small$i \in \{1,2\}$}) $\mathcal{D}$ proves $\Gamma_1 , \Gamma_2 \Rightarrow A_1 \lor A_2$ and has a sub-proof for $\Gamma_1 , \Gamma_2 \Rightarrow A_i$. Take $C = C_{\langle\Gamma_1;\Gamma_2;A_i\rangle}$. Then we have $\Gamma_1 \Rightarrow C$ from IH and $\Gamma_2 , C \Rightarrow A_1 \lor A_2$ from IH and $R\lor_i$.
	From IH, we also have $P(C) \subseteq P(\Gamma_1) \cap P(\Gamma_2 , A_1 \lor A_2)$, as was justified before.
	\setcounter{enumi}{11}
	
	\item ($L\rightarrow$) $\mathcal{D}$ proves $\Gamma_1' , \Gamma_2' , \nabla^n (A \rightarrow B) \Rightarrow \Delta$ and has sub-proofs for $\Gamma_1' , \Gamma_2' \Rightarrow \nabla^n A$ and $\Gamma_1' , \Gamma_2' , \nabla^n B \Rightarrow \Delta$.
	\begin{enumerate}
		\item If $\Gamma_1 = \Gamma_1'$ and $\Gamma_2 = \Gamma_2' , \nabla^n (A \rightarrow B)$, let $C_1 = C_{\langle\Gamma_1';\Gamma_2';\nabla^n A\rangle}$ and $C_2 = C_{\langle\Gamma_1';\Gamma_2',\nabla^n B;\Delta\rangle}$, and take $C = C_1 \land C_2$.
		We have $\Gamma_1' \Rightarrow C_1 \land C_2$ from IH and $R\land$.
		From IH, by $L\land_1$ and $L\land_2$ we can derive $\Gamma_2' , C_1 \land C_2 \Rightarrow \nabla^n A$ and $\Gamma_2' , \nabla^n B , C_1 \land C_2 \Rightarrow \Delta$ respectively, to which we apply $L\rightarrow$ to get $\Gamma_2' , \nabla^n (A \rightarrow B) , C_1 \land C_2 \Rightarrow \Delta$.
		From IH, we also have $P(C_1) \subseteq P(\Gamma_1') \cap$ $P(\Gamma_2' , \nabla^n A)$ and $P(C_2) \subseteq P(\Gamma_1') \cap P(\Gamma_2' , \nabla^n B , \Delta)$. This implies $P(C_1 \land C_2) \subseteq P(\Gamma_1') \cap P(\Gamma_2' , \nabla^n (A \rightarrow B) , \Delta)$.

		\item If $\Gamma_1 = \Gamma_1' , \nabla^n (A \rightarrow B)$ and $\Gamma_2 = \Gamma_2'$, let $C_1 = C_{\langle\Gamma_2';\Gamma_1';\nabla^n A\rangle}$ and $C_2 = C_{\langle\Gamma_1',\nabla^n B;\Gamma_2';\Delta\rangle}$, and take $C = C_1 \rightarrow C_2$.
		From IH we have $\Gamma_1' , C_1 \Rightarrow \nabla^n A$ and $\Gamma_1' , \nabla^n B , C_1 \Rightarrow C_2$, with a $Lw$ to introduce $C_1$ to the left. From $L\rightarrow$ we get $\Gamma_1 , \nabla^n (A \rightarrow B) , C_1 \Rightarrow C_2$, to which we can apply $R\rightarrow$ to get $\Gamma_1 , \nabla^n (A \rightarrow B) \Rightarrow C_1 \rightarrow C_2$.

		From IH, we have also $\Gamma_2' \Rightarrow C_1$ and $\Gamma_2' , C_2 \Rightarrow \Delta$, from which we can derive $\Gamma_2' , C_1 \rightarrow C_2 \Rightarrow \Delta$ by an application of $L\rightarrow$. IH also states that $P(C_1) \subseteq P(\Gamma_2') \cap P(\Gamma_1' , \nabla^n A)$ and $P(C_2) \subseteq P(\Gamma_1' , \nabla^n B) \cap P(\Gamma_2' , \Delta)$. Then $P(C_1 \rightarrow C_2) \subseteq P(\Gamma_1' , \nabla^n (A \rightarrow B)) \cap P(\Gamma_2' , \Delta)$.
	\end{enumerate}

	\item ($R\rightarrow$) $\mathcal{D}$ proves $\Gamma_1 , \Gamma_2 \Rightarrow A \rightarrow B$ and has a sub-proof for $\Gamma_1 , \Gamma_2 , A \Rightarrow B$. Let $C = C_{\langle\Gamma_1;\Gamma_2,A;B\rangle}$. So we have $\Gamma_1 \Rightarrow C$ and $\Gamma_2 , C \Rightarrow A \rightarrow B$ from IH and an application of $R\rightarrow$.
	We also have $P(C) \subseteq P(\Gamma_1) \cap P(\Gamma_2 , A \rightarrow B)$ from IH and the fact that $P$ preserves sub-formula ordering in $\subseteq$.

	\item ($L\rightsquigarrow$) This case is similar to $L\rightarrow$. 

	\item ($N$) $\mathcal{D}$ proves $\nabla \Gamma_1 , \nabla \Gamma_2 \Rightarrow \nabla \Delta$ and has a sub-proof for $\Gamma_1 , \Gamma_2 \Rightarrow \Delta$. Just take $C = C(\Gamma_1;\Gamma_2;\Delta)$ and apply $N$ on the sequents from IH. The variable condition is also trivial.
\end{enumerate}
\end{proof}

\begin{thebibliography}{99}
\addcontentsline{toc}{section}{References}

\bibitem{Amir}
A. Akbar Tabatabai. ``Implication via Spacetime." arXiv preprint arXiv:2001.00997 (2019).
\bibitem{Artemov}
S. Artemov, J. Davoren, and A. Nerode. Modal logics and topological semantics for hybrid systems. Technical Report MSI 97-05, 1997.
\bibitem{Ewald}
W. Ewald. Intuitionistic tense and modal logic. The Journal of Symbolic Logic, 51(1):166–179, 1986.
\bibitem{Duque}
D. Fernández-Duque. The intuitionistic temporal logic of dynamical systems. Log. Methods Comput. Sci. 14(3) (2018)
\bibitem{Mints}
P. Kremer and G. Mints. Dynamic topological logic. Annals of Pure and Applied Logic, 131:133–158, 2005.

\end{thebibliography}



\end{document}
